Search.setIndex({"docnames": ["api", "api_actors", "api_generator", "api_model", "api_service", "api_trainer", "getting_started", "index", "tutorials", "tutorials/zero-to-forge/1_RL_and_Forge_Fundamentals", "tutorials/zero-to-forge/2_Forge_Internals", "tutorials/zero-to-forge/3_Monarch_101", "zero-to-forge-intro"], "filenames": ["api.md", "api_actors.md", "api_generator.md", "api_model.md", "api_service.md", "api_trainer.md", "getting_started.md", "index.md", "tutorials.md", "tutorials/zero-to-forge/1_RL_and_Forge_Fundamentals.md", "tutorials/zero-to-forge/2_Forge_Internals.md", "tutorials/zero-to-forge/3_Monarch_101.md", "zero-to-forge-intro.md"], "titles": ["API Reference", "ForgeActor", "Generator", "Model", "Service", "Trainer", "Getting Started", "TorchForge Documentation", "Tutorials", "Part 1: RL Fundamentals - Using TorchForge Terminology", "Part 2: Peeling Back the Abstraction - What Are Services?", "Part 3: The TorchForge-Monarch Connection", "Zero to TorchForge: From RL Theory to Production-Scale Implementation"], "terms": {"thi": [0, 1, 2, 3, 4, 5, 6, 8, 10, 12], "section": [0, 6, 8, 9, 10, 11, 12], "provid": [0, 1, 3, 4, 5, 6, 7, 8, 9, 10], "comprehens": [0, 4, 12], "document": [0, 3, 5, 6], "torchforg": [0, 1, 2, 5, 6, 8], "i": [0, 1, 2, 3, 4, 5, 6, 7, 9, 10, 11, 12], "pytorch": [0, 5, 6, 7, 11, 12], "nativ": [0, 7], "platform": [0, 7], "post": [0, 7], "train": [0, 1, 3, 7, 8, 9], "gener": [0, 1, 5, 7, 9, 10], "ai": [0, 6, 7, 9], "model": [0, 1, 2, 6, 7, 8, 9, 10, 11, 12], "design": [0, 2], "streamlin": 0, "reinforc": [0, 1, 2, 3, 5, 6, 7, 12], "learn": [0, 1, 2, 3, 5, 6, 7, 10, 12], "workflow": [0, 1, 2, 5, 7], "larg": [0, 7, 9], "languag": [0, 12], "The": [0, 1, 2, 3, 4, 5, 6, 12], "leverag": [0, 7], "": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12], "distribut": [0, 1, 3, 5, 6, 7, 8, 9, 10, 12], "comput": [0, 3, 5, 9, 10], "capabl": [0, 7, 8], "built": [0, 1, 2, 5, 6, 7, 10, 11], "top": [0, 2, 5, 11], "monarch": [0, 2, 6, 7, 10, 12], "make": [0, 2, 6, 7], "extens": [0, 7], "us": [0, 1, 2, 3, 4, 5, 6, 7, 10, 12], "actor": [0, 1, 2, 3, 4, 5, 6, 7, 9, 10], "fault": [0, 7, 10], "toler": [0, 7, 10], "kei": [0, 4, 5, 6, 7, 9, 10], "featur": [0, 5, 6, 7], "includ": [0, 4, 5, 6, 7], "base": [0, 1, 2, 3, 5, 7, 9, 10], "architectur": [0, 3], "an": [0, 1, 4, 5, 9, 10, 12], "system": [0, 1, 3, 5, 7, 9, 10, 11, 12], "excel": 0, "scalabl": 0, "ensur": [0, 5, 6, 7, 10], "seamless": 0, "integr": [0, 7], "exist": [0, 5, 7], "focu": [0, 7, 9], "specif": [0, 4, 5, 6, 7, 10, 11], "techniqu": [0, 7], "like": [0, 1, 5, 6, 7, 9, 10, 11], "rlvr": [0, 7], "sft": [0, 7, 12], "other": [0, 1, 2, 3, 5, 9, 10], "align": [0, 7], "method": [0, 1, 3, 4, 5, 10, 11], "support": [0, 5, 6, 7], "multi": [0, 6, 7, 10], "gpu": [0, 1, 4, 5, 6, 7, 9, 10, 11], "node": 0, "out": [0, 7], "box": 0, "For": [0, 3, 5, 6, 7, 10], "most": [0, 5, 10], "case": [0, 5], "you": [0, 1, 5, 6, 8, 9, 10, 12], "ll": [0, 9], "interact": [0, 7, 9], "high": [0, 7, 9, 10], "level": [0, 9, 11], "servic": [0, 1, 12], "interfac": [0, 9], "which": [0, 4, 5, 11], "handl": [0, 4, 5, 6, 7, 9, 11], "complex": [0, 1, 7, 10, 11], "coordin": [0, 6, 7], "automat": [0, 1, 4, 5, 7, 10, 11], "advanc": [0, 8], "user": [0, 5], "who": 0, "need": [0, 1, 4, 5, 10], "fine": [0, 7, 8], "grain": 0, "control": [0, 1, 2, 4, 5, 7, 10], "individu": [0, 11], "direct": 0, "access": [0, 6], "underli": [0, 11], "compon": [0, 1, 5, 6, 7], "forgeactor": [0, 2, 3, 10, 11], "trainer": [0, 6, 9, 10], "modul": [1, 5, 7], "contain": [1, 5], "core": [1, 2, 6, 11], "infer": [1, 2, 3, 5, 6, 7, 9, 10], "These": [1, 10], "pre": [1, 5, 6, 7], "essenti": [1, 7, 10], "function": [1, 4, 5, 6, 10, 11], "can": [1, 5, 6, 9, 10, 11, 12], "build": [1, 6, 10, 12], "block": [1, 7, 10], "class": [1, 2, 3, 4, 5, 10, 11], "forg": [1, 2, 3, 4, 5, 6, 7, 9, 10], "arg": [1, 4, 5], "kwarg": [1, 4], "sourc": [1, 2, 3, 4, 5, 10, 11], "configur": [1, 3, 4, 7], "resourc": [1, 4, 7, 10, 11], "attribut": 1, "initi": [1, 5, 10, 11], "set": [1, 3, 5, 6], "up": [1, 4, 5], "log": [1, 3, 4], "rank": [1, 5], "size": [1, 3, 5, 6, 9], "inform": [1, 4], "process": [1, 5, 6, 9, 10], "mesh": [1, 2, 7], "refer": [1, 3, 5, 6, 7, 9, 12], "ar": [1, 2, 4, 5, 6, 9, 11, 12], "determin": [1, 10], "from": [1, 3, 4, 5, 6, 7, 8, 10, 11], "current": [1, 5, 6, 7, 10, 12], "execut": [1, 2, 7], "context": [1, 5, 10], "paramet": [1, 2, 4, 5, 6, 10, 11], "variabl": [1, 3], "length": [1, 5], "argument": [1, 2, 4, 5, 11], "list": [1, 4, 5, 9, 10], "pass": [1, 3, 4, 5, 11], "parent": 1, "arbitrari": 1, "keyword": [1, 4], "async": [1, 2, 4, 5, 7, 9, 10, 11], "classmethod": [1, 2], "as_actor": [1, 9, 10, 11], "actor_kwarg": [1, 4], "spawn": [1, 6, 10, 11], "singl": [1, 5, 7, 9], "store": [1, 5, 7, 9, 10], "option": [1, 2, 3, 5, 9, 10, 11], "default": [1, 2, 5, 10], "valu": [1, 5, 7, 10, 11], "subclass": 1, "return": [1, 2, 3, 4, 5, 9, 10, 11], "proc": [1, 2, 6, 9, 10, 11], "construct": 1, "processconfig": 1, "instanc": [1, 2, 5, 9, 10, 11], "If": [1, 2, 4, 5, 6, 9, 12], "wa": 1, "type": [1, 2, 4, 5, 9], "typevar": 1, "t": [1, 5, 6, 10, 11], "bound": [1, 10], "host": [1, 10], "none": [1, 2, 5, 9, 10, 11], "number": [1, 4, 5, 10, 11], "across": [1, 5, 6, 7, 10, 11], "mani": [1, 5, 10, 11], "accommod": 1, "request": [1, 4, 7, 9, 10], "launch": 1, "provis": 1, "deploi": 1, "new": [1, 4, 5, 6, 10], "replica": [1, 4, 9, 11], "we": [1, 5, 9, 10, 11], "implement": [1, 4, 5, 7, 8, 9], "wai": [1, 5, 10], "becaus": [1, 5], "special": [1, 7], "server": 1, "mai": [1, 5, 9], "compos": [1, 7], "multipl": [1, 9, 10], "allow": [1, 5], "specifi": [1, 5], "how": [1, 5, 9, 12], "your": [1, 7, 9, 10], "get": [1, 2, 4, 7, 9, 10, 11], "togeth": [1, 9], "basic": [1, 6, 8, 10, 11], "assum": [1, 10], "re": [1, 12], "homogen": 1, "actormesh": [1, 10, 11], "mesh_nam": 1, "name": [1, 4, 5, 6, 10], "num_replica": [1, 2, 9, 10], "1": [1, 2, 5, 7, 11, 12], "creat": [1, 5, 6, 9, 10, 11], "when": [1, 4, 5, 6, 9, 10, 11], "onli": [1, 3, 5, 11], "appli": [1, 5], "as_servic": [1, 2, 9, 10, 11], "with_gpu": [1, 2, 9, 10], "fals": [1, 5, 9, 10], "version": [1, 6, 10], "befor": [1, 6, 7, 10], "each": [1, 4, 5, 9, 10, 11, 12], "call": [1, 2, 4, 5, 9, 10], "separ": [1, 5, 11], "so": 1, "differ": [1, 2, 5, 10, 11], "coexist": 1, "without": [1, 3, 5, 7, 10, 11], "interf": 1, "exampl": [1, 2, 4, 5, 7, 11, 12], "rtype": 1, "await": [1, 2, 4, 7, 9, 10, 11], "myforgeactor": 1, "2": [1, 5, 11, 12], "shutdown": [1, 2, 10], "usag": [1, 5, 9, 10, 11], "shut": [1, 10], "down": [1, 10], "teardown": 1, "whether": [1, 2, 5, 11], "alloc": [1, 10], "polici": [2, 3, 5, 6, 7, 9, 10, 11], "engin": [2, 3, 5, 7, 12], "vllm": [2, 6, 7], "It": [2, 3, 5, 12], "manag": [2, 4, 5, 6, 7, 11], "serv": [2, 3, 11], "text": [2, 7, 9, 10], "weight": [2, 5, 6, 7, 9], "updat": [2, 4, 5, 9, 10], "engine_arg": 2, "factori": [2, 3, 5], "sampling_param": 2, "use_dcp_for_weight_sync": 2, "prefetch_weights_to_shm": 2, "true": [2, 5, 9, 10], "n_fetcher_proc": 2, "8": [2, 5, 6, 9, 10, 11], "manual": [2, 5, 10], "recreat": 2, "mirror": 2, "asyncllmengin": 2, "v1": 2, "main": [2, 6, 9, 10], "all": [2, 4, 5, 6, 7, 9, 10, 11], "commun": [2, 3, 5, 9, 11], "here": [2, 5, 6, 9, 10], "via": [2, 5], "enginearg": 2, "samplingparam": 2, "sampl": [2, 7, 9, 10], "bool": 2, "dcp": [2, 5], "nf": 2, "sync": [2, 6], "depend": [2, 6, 7], "rdma": [2, 7], "enabl": [2, 3, 4, 5, 6], "torchstor": [2, 6, 7, 10], "disabl": [2, 4, 5], "otherwis": [2, 5, 10], "tell": 2, "me": 2, "joke": 2, "complet": [2, 4, 5, 7, 9, 10], "prompt": [2, 7, 9, 10], "A": [2, 3, 5, 10, 12], "why": 2, "did": [2, 9], "chicken": 2, "cross": [2, 11], "road": 2, "b": 2, "To": 2, "side": 2, "token_id": [2, 7, 9, 10], "logprob": [2, 9], "get_vers": [2, 10], "get_vllm_config": 2, "register_work": 2, "run": [2, 3, 5, 6, 7, 10], "schedul": [2, 5], "output": [2, 5, 6, 10, 11], "project": [2, 7], "setup": [2, 3, 5, 7], "stop": [2, 4, 9, 11], "update_weight": [2, 9, 10], "vllm_config": 2, "gpuwork": 2, "In": [2, 5, 9, 10, 11], "should": [2, 4, 5, 7], "instanti": [2, 4], "directli": [2, 6, 9, 11], "rather": [2, 6], "creation": 2, "invoc": 2, "execute_model": 2, "setup_kv_cach": 2, "reference_model": [3, 9, 10], "frozen": [3, 6], "copi": [3, 5, 9], "advantag": [3, 9, 10], "perform": [3, 4, 5, 7, 10, 11], "input": [3, 5, 9, 10], "sequenc": [3, 5], "logit": [3, 5], "probabl": 3, "kl": [3, 5], "diverg": [3, 5], "rl": [3, 8, 10, 11], "metric": [3, 4], "parallel": [3, 6, 7, 9, 10], "checkpoint": [3, 6, 10], "compil": [3, 5], "comm": [3, 5], "torchtitan": [3, 5, 6, 7], "forward": [3, 5, 9, 10], "gradient": [3, 5], "typic": [3, 5, 6, 10], "maintain": [3, 4, 7, 10, 11], "algorithm": [3, 5, 7], "consist": [3, 4], "optim": [3, 7, 9, 10, 11], "grpo": [3, 5, 7, 9, 10], "group": [3, 5, 7, 10], "rel": [3, 5, 7], "ppo": [3, 7], "proxim": 3, "where": [3, 5, 6, 9, 10, 11], "fix": 3, "point": [3, 5, 11], "penalti": [3, 5], "against": [3, 5], "load": [3, 4, 5, 9], "evalu": [3, 9, 10], "mode": [3, 5, 9], "inference_mod": 3, "memori": [3, 5, 7, 9, 11], "effici": [3, 7, 10], "vocab": 3, "etc": [3, 5, 6, 10, 11], "collect": [3, 5, 9, 11], "strategi": [3, 5, 6, 9], "dp": [3, 5], "tp": [3, 5], "pp": [3, 5], "cp": [3, 5], "torch": [3, 5, 6, 9, 10], "backend": 3, "relat": 3, "dtype": [3, 5, 9], "garbag": [3, 5, 10], "subset": 3, "dataclass": 3, "detail": [3, 4, 6, 9, 12], "cfg": 4, "actor_def": 4, "actor_arg": 4, "less": 4, "temporari": [4, 5], "solut": [4, 10], "nest": 4, "prove": 4, "problemat": 4, "temporarili": 4, "per": [4, 5, 10, 11], "health": [4, 10], "poll": 4, "rate": [4, 5, 6], "definit": [4, 5, 10], "posit": 4, "constructor": [4, 11], "member": 4, "call_al": 4, "start_sess": 4, "get_metr": 4, "get_metrics_summari": 4, "terminate_sess": 4, "show": [4, 11], "inherit": 4, "broadcast": [4, 11], "healthi": [4, 9, 10], "result": [4, 5, 11], "endpoint": [4, 10, 11], "rais": 4, "runtimeerror": 4, "avail": [4, 5, 6, 10], "monitor": [4, 10], "analysi": 4, "data": [4, 5, 6, 7, 9, 10], "wide": 4, "aggreg": 4, "statu": [4, 7], "servicemetr": 4, "object": [4, 7, 10], "print": [4, 5, 6, 10, 11], "f": [4, 6, 9, 10, 11], "get_total_request_r": 4, "1f": 4, "req": 4, "queue": 4, "depth": 4, "get_avg_queue_depth": 4, "summari": [4, 10], "debug": [4, 5, 11], "structur": [4, 9, 10, 11], "format": [4, 5], "suitabl": 4, "dashboard": 4, "purpos": [4, 11], "dict": [4, 5], "healthy_replica": 4, "idx": 4, "item": 4, "request_r": 4, "start": [4, 7, 9], "session": [4, 11], "state": [4, 5, 11], "affin": 4, "workload": 4, "requir": [4, 5, 9, 10], "uniqu": 4, "id": 4, "assign": [4, 11], "least": [4, 9], "str": [4, 6, 10], "identifi": 4, "subsequ": 4, "session_id": 4, "my_endpoint": 4, "arg1": 4, "arg2": 4, "longer": [4, 6], "sess_id": 4, "termin": [4, 5], "activ": [4, 5, 6], "clean": 4, "associ": 4, "remov": [4, 6, 10], "track": 4, "clear": [4, 10], "free": [4, 6], "backward": 5, "lr_schedul": 5, "activation_checkpoint": 5, "quantiz": 5, "memory_estim": 5, "loss": [5, 9, 10], "lambda": 5, "state_dict_kei": 5, "model_state_dict": 5, "use_dcp": 5, "dcp_path": 5, "forge_dcp_tmp": 5, "loop": [5, 9], "step": [5, 7, 8, 10, 11], "unlik": [5, 9], "referencemodel": [5, 9, 10], "through": [5, 6, 10], "descent": 5, "same": [5, 9, 10, 11], "doe": [5, 9], "limit": [5, 10], "tensor": [5, 6, 7, 9, 10], "fsdp": [5, 6, 7], "fulli": [5, 7], "shard": [5, 6, 9], "conjunct": 5, "propag": 5, "mix": [5, 7, 9], "precis": [5, 6], "amp": 5, "cleanup": [5, 10, 11], "forward_backward": 5, "target": [5, 7, 9, 10], "push_weight": [5, 9, 10], "train_step": [5, 9, 10], "follow": [5, 6, 7], "config": [5, 6, 9, 10], "job_config": 5, "config_fil": 5, "dump_fold": 5, "descript": 5, "print_arg": 5, "file": [5, 7], "folder": 5, "dump": 5, "llama3": [5, 7], "flavor": [5, 9, 10], "debugmodel": 5, "hf_assets_path": [5, 9, 10], "test": [5, 6, 7], "asset": 5, "token": [5, 9, 10], "tokenizer_path": 5, "convert": 5, "print_after_convers": 5, "comma": 5, "float8": 5, "swap": 5, "nn": 5, "linear": 5, "float8linear": 5, "instal": [5, 7], "torchao": 5, "found": 5, "ao": 5, "path": [5, 6, 9, 10], "hf": [5, 6, 9, 10], "local": [5, 6, 11], "hug": [5, 6], "face": [5, 6], "safetensor": 5, "index": [5, 7], "json": 5, "fqn": 5, "map": [5, 9, 11], "generation_config": 5, "stdout": 5, "after": [5, 6], "have": [5, 6, 10, 11], "been": [5, 7], "instead": [5, 6, 10, 11], "deprec": 5, "adamw": [5, 9, 10], "lr": [5, 9, 10], "0": [5, 6, 9, 10, 11], "0008": 5, "beta1": 5, "9": 5, "beta2": 5, "95": [5, 9], "ep": 5, "1e": [5, 6, 9, 10], "08": 5, "weight_decai": 5, "fuse": 5, "early_step_in_backward": 5, "exponenti": 5, "move": 5, "averag": [5, 10], "hyperparamet": [5, 6], "caution": 5, "optimizer_in_backward": 5, "compat": 5, "clip": 5, "register_post_accumulate_grad_hook": 5, "epsilon": 5, "cuda": [5, 6], "best": 5, "foreach": 5, "some": [5, 6, 9, 10, 12], "horizont": 5, "fusion": 5, "better": [5, 9], "slowest": [5, 10], "more": [5, 6, 10, 12], "info": 5, "http": [5, 6, 7], "org": [5, 6, 7], "doc": [5, 6, 7, 12], "stabl": 5, "html": 5, "decai": 5, "dataset": [5, 6, 9], "c4_test": 5, "dataset_path": 5, "local_batch_s": [5, 9, 10], "global_batch_s": 5, "seq_len": [5, 9, 10], "2048": [5, 9, 10], "max_norm": 5, "10000": 5, "enable_cpu_offload": 5, "float32": 5, "mixed_precision_param": 5, "bfloat16": [5, 9], "mixed_precision_reduc": 5, "gc_freq": 5, "50": 5, "gc_debug": 5, "seed": 5, "determinist": 5, "download": [5, 6], "wherev": 5, "possibl": 5, "slower": 5, "contrast": 5, "training_dtyp": 5, "put": 5, "extra": 5, "fp32": 5, "full": [5, 6, 9, 10], "bf16": [5, 6], "rope": 5, "calcul": 5, "still": 5, "cpu": [5, 9, 10, 11], "offload": 5, "gc": 5, "everi": 5, "detect": 5, "cycl": 5, "note": [5, 6, 9, 10, 11], "want": [5, 10], "lower": 5, "avoid": [5, 6, 10], "too": [5, 10, 12], "python": [5, 6, 7, 10], "interv": 5, "global": 5, "batch": [5, 6, 7, 9, 10], "degre": [5, 7], "e": [5, 6], "devic": 5, "max": 5, "norm": 5, "fully_shard": 5, "autocast": 5, "take": 5, "effect": [5, 10, 11], "data_parallel_shard_degre": 5, "context_parallel_degre": 5, "data_replicate_degre": 5, "under": [5, 10], "ddp": 5, "reduct": 5, "choos": [5, 7, 10, 11], "rng": 5, "data_parallel_replicate_degre": 5, "enable_compiled_autograd": 5, "fsdp_reshard_after_forward": 5, "tensor_parallel_degre": 5, "disable_loss_parallel": 5, "enable_async_tensor_parallel": 5, "pipeline_parallel_degre": 5, "pipeline_parallel_split_point": 5, "module_fqns_per_model_part": 5, "pipeline_parallel_first_stage_less_lay": 5, "pipeline_parallel_last_stage_less_lay": 5, "pipeline_parallel_layers_per_stag": 5, "pipeline_parallel_schedul": 5, "1f1b": 5, "pipeline_parallel_schedule_csv": 5, "pipeline_parallel_microbatch_s": 5, "context_parallel_rotate_method": 5, "allgath": 5, "expert_parallel_degre": 5, "expert_tensor_parallel_degre": 5, "mean": [5, 11], "sdpa": 5, "kv": 5, "exchang": 5, "gather": [5, 9, 10], "first": [5, 6, 7, 10], "sub": 5, "alltoal": 5, "shuffl": 5, "replic": [5, 9], "greater": 5, "than": [5, 6, 10], "also": 5, "hsdp": 5, "hybrid": 5, "leftov": 5, "dp_replic": 5, "sp": 5, "neg": 5, "compiledautograd": 5, "expert": 5, "No": [5, 7, 9, 11], "non": [5, 7, 10], "moe": 5, "constraint": 5, "etp": 5, "dp_shard": 5, "experiment": [5, 7], "relax": 5, "soon": [5, 10, 12], "flexibl": 5, "devicemesh": 5, "With": [5, 7], "rout": [5, 7, 9, 11], "param": 5, "either": [5, 6], "partial": 5, "reshard_after_forward": 5, "within": [5, 10], "behavior": [5, 6], "trade": 5, "off": [5, 7], "see": [5, 9, 10], "api": [5, 6, 7, 9, 10, 11, 12], "alwai": [5, 11], "never": 5, "reshard": [5, 7], "smart": 5, "known": 5, "scenario": [5, 8], "qualifi": 5, "chunk": 5, "inner": 5, "repres": 5, "one": [5, 10, 11], "belong": 5, "g": 5, "tok_embed": 5, "layer": [5, 9, 11, 12], "3": [5, 6, 7, 12], "4": [5, 6, 9, 10, 11], "second": 5, "third": 5, "explicit": 5, "over": 5, "compar": [5, 9], "split": 5, "pipelin": [5, 7, 9], "physic": 5, "stage": 5, "reduc": 5, "ha": [5, 7, 9, 10], "overhead": 5, "embed": 5, "present": 5, "last": 5, "virtual": 5, "microbatch": 5, "total": [5, 10], "divid": 5, "must": 5, "evenli": 5, "divis": 5, "stages_per_rank": 5, "interleaved1f1b": 5, "split_point": 5, "csv": 5, "pipelineschedulesingl": 5, "pipelineschedulemulti": 5, "_pipelinescheduleruntim": 5, "begin": 5, "caus": 5, "remain": 5, "autom": 5, "futur": [5, 11], "500": 5, "initial_load_path": 5, "initial_load_model_onli": 5, "initial_load_in_hf": 5, "last_save_model_onli": 5, "last_save_in_hf": 5, "export_dtyp": 5, "async_mod": 5, "keep_latest_k": 5, "10": [5, 6, 10], "load_step": 5, "exclude_from_load": 5, "enable_first_step_checkpoint": 5, "create_seed_checkpoint": 5, "synchron": [5, 6, 7, 9], "async_sav": 5, "async_with_pinned_mem": 5, "util": [5, 9], "dedic": 5, "pin": 5, "space": [5, 6], "faster": [5, 6, 10], "transfer": [5, 7], "elimin": [5, 7, 10], "gil": 5, "content": 5, "cost": 5, "increas": [5, 10], "insuffici": 5, "degrad": [5, 9], "due": 5, "page": 5, "suffic": 5, "small": [5, 9], "order": 5, "ten": 5, "frequenc": [5, 10], "emploi": 5, "pursu": 5, "zero": [5, 7, 8], "time": [5, 7, 9], "given": 5, "appropri": 5, "hardwar": [5, 11], "ampl": 5, "fast": [5, 6, 10], "pcie": 5, "save": [5, 6], "py": [5, 6, 9, 10], "ani": [5, 7, 9, 10], "ngpu": 5, "could": 5, "script": [5, 6], "share": [5, 10], "code": [5, 6, 9, 10], "immedi": [5, 10], "correctli": [5, 6], "cluster": [5, 7, 11], "storag": [5, 9, 10], "verifi": [5, 7, 9, 10, 11], "wait": [5, 9, 10], "frequent": 5, "exclud": [5, 6], "being": [5, 6, 9, 10], "dataload": [5, 7, 9, 10], "huggingfac": [5, 6], "necessari": 5, "transform": 5, "doesn": [5, 10], "dure": 5, "treat": [5, 9], "standard": 5, "no_initial_load_model_onli": 5, "overrid": 5, "particularli": 5, "resum": 5, "previou": [5, 10, 11], "empti": 5, "locat": [5, 11], "ignor": 5, "continu": [5, 7, 9, 10, 11], "affect": 5, "ones": 5, "pre_train": 5, "llama3_8b": [5, 6], "step_10000": 5, "keep": [5, 9], "latest": [5, 6, 11], "k": 5, "purg": 5, "older": 5, "cannot": 5, "As": 5, "metadata": 5, "readi": [5, 10], "yet": [5, 10], "fill": 5, "disk": [5, 6], "final": [5, 10], "There": 5, "consolid": [5, 6], "On": 5, "isn": 5, "end": [5, 10], "weights_onli": 5, "convers": [5, 10], "train_stat": 5, "guid": [6, 7, 8, 11, 12], "walk": 6, "its": [6, 11], "job": 6, "meet": [6, 7], "oper": 6, "linux": 6, "fedora": 6, "ubuntu": 6, "debian": 6, "maco": 6, "window": 6, "higher": [6, 10], "11": [6, 11], "recommend": [6, 10], "nvidia": 6, "amd": 6, "minimum": [6, 7], "larger": 6, "12": 6, "ram": 6, "32gb": 6, "50gb": 6, "nightli": [6, 7], "dtensor": [6, 7], "packag": 6, "wheel": 6, "orchestr": [6, 7], "v0": 6, "pagedattent": [6, 7], "product": [6, 7, 8, 10], "infrastructur": [6, 7], "conda": 6, "miniconda": 6, "environ": [6, 7, 9], "io": 6, "github": [6, 7], "cli": 6, "gh": 6, "instruct": [6, 7], "com": [6, 7], "authent": 6, "auth": 6, "login": 6, "ssh": 6, "protocol": 6, "git": 6, "clone": 6, "repositori": 6, "usual": [6, 10], "alreadi": [6, 10], "reliabl": 6, "meta": [6, 7], "cd": 6, "n": [6, 9, 10], "sh": 6, "dnf": 6, "sudo": 6, "prefer": [6, 7], "ad": 6, "pyproject": 6, "toml": 6, "uv": 6, "inexact": 6, "work": [6, 7, 9, 11], "check": [6, 7, 10, 11], "c": 6, "import": [6, 9, 10, 11], "device_count": 6, "expect": [6, 7], "success": 6, "__version__": 6, "this_host": [6, 11], "spawn_proc": [6, 11], "now": [6, 9, 10, 11], "let": [6, 7, 9, 11], "what": [6, 12], "look": [6, 7, 9, 10, 11], "llama": 6, "8b": [6, 7], "dir": 6, "tmp": 6, "origin": [6, 9], "00": 6, "pth": 6, "nproc_per_nod": 6, "app": [6, 9, 10, 11], "yaml": [6, 9], "m": 6, "qwen3_1_7b": 6, "haven": 6, "happen": [6, 10], "power": [6, 7, 10, 11], "baselin": [6, 9], "score": [6, 7, 9, 10], "three": 6, "examin": 6, "batch_siz": [6, 9, 10], "learning_r": 6, "5": [6, 9, 10, 11], "num_epoch": 6, "gradient_accumulation_step": 6, "save_interv": 6, "1000": 6, "output_dir": 6, "explor": 6, "directori": 6, "read": [6, 10], "tutori": [6, 7], "encount": 6, "issu": [6, 7, 11], "search": 6, "bug": [6, 7], "report": [6, 7], "diagnost": 6, "command": 6, "below": [6, 9, 12], "error": 6, "messag": [6, 10, 11], "reproduc": 6, "v": [6, 9, 11], "actual": [6, 7, 9], "try": 6, "monarch_statu": 6, "ok": 6, "except": 6, "vllm_version": 6, "contribut": [6, 7, 10], "md": [6, 7], "conduct": [6, 7], "code_of_conduct": [6, 7], "librari": 7, "agent": 7, "develop": 7, "research": 7, "earli": 7, "incomplet": 7, "chang": [7, 11], "pleas": [7, 12], "becom": [7, 9], "frontier": 7, "reason": 7, "But": [7, 10], "often": 7, "domin": 7, "express": 7, "natur": [7, 10, 12], "pseudocod": [7, 9], "while": [7, 9, 10, 11], "underneath": 7, "Not": [7, 10], "logic": [7, 9], "asynchroni": 7, "match": 7, "proven": 7, "framework": [7, 11], "custom": 7, "solid": 7, "simplifi": [7, 10], "program": 7, "carefulli": 7, "select": [7, 10], "battl": 7, "d": 7, "machin": 7, "matter": 7, "spmd": 7, "tractabl": 7, "throughput": [7, 9, 10], "scale": [7, 8, 11], "grade": [7, 9], "llm": 7, "solv": [7, 9], "bottleneck": [7, 9, 10, 11], "supervis": [7, 9], "tune": [7, 8], "adapt": 7, "task": 7, "label": 7, "reward": [7, 9, 10], "human": 7, "asynchron": 7, "rollout": [7, 10], "maximum": [7, 11], "safe": [7, 10], "sandbox": 7, "tool": 7, "own": [7, 9, 11], "them": 7, "dive": 7, "def": [7, 9, 10, 11], "generate_episod": 7, "replay_buff": [7, 9, 10], "respons": [7, 9, 10], "reward_valu": 7, "evaluate_respons": [7, 9, 10], "add": [7, 9, 10, 11], "episod": [7, 9, 10], "prompt_id": [7, 9, 10], "response_id": 7, "retri": [7, 9, 10], "just": [7, 9, 11], "prerequisit": 7, "verif": 7, "15": [7, 10], "minut": 7, "practic": 7, "hand": 7, "deep": 7, "real": [7, 9, 11], "world": 7, "deploy": 7, "stanford": 7, "collabor": 7, "weaver": 7, "weak": 7, "hill": 7, "climb": 7, "challeng": [7, 10], "benchmark": 7, "math": [7, 10], "gpqa": 7, "coreweav": 7, "512": [7, 9, 10], "h100": 7, "smooth": 7, "hundr": 7, "signific": 7, "signal": 7, "intent": 7, "tracker": 7, "popular": 7, "qwen3": [7, 9, 10, 11], "7b": [7, 9, 10, 11], "quick": [7, 9, 12], "understand": [7, 9, 10, 11, 12], "next": [7, 9, 10, 12], "help": [7, 8, 11], "addit": [7, 10], "theori": [7, 8], "overview": 7, "licens": 7, "bsd": 7, "claus": 7, "master": 8, "simpl": [9, 10, 11], "tutor": 9, "exact": [9, 10], "question": [9, 10], "answer": [9, 10], "qualiti": [9, 10], "give": [9, 10, 12], "prevent": 9, "drift": 9, "replai": 9, "buffer": 9, "experi": [9, 10], "conceptu": [9, 10, 12], "conceptual_rl_step": 9, "student": 9, "teacher": 9, "reward_model": 9, "compute_logprob": 9, "6": [9, 11], "enough": [9, 10], "improv": 9, "curr_policy_vers": [9, 10], "insight": [9, 10], "abov": 9, "again": 9, "would": [9, 10], "conceptual_forge_rl_step": 9, "datasetactor": [9, 10], "call_on": [9, 10, 11], "rewardactor": [9, 10], "reward_actor": [9, 10], "input_id": [9, 10], "max_req_token": [9, 10], "return_logprob": [9, 10], "ref_logprob": [9, 10], "ref_model": [9, 10], "create_episode_from_respons": 9, "pattern": [9, 11], "auto": 9, "realis": 9, "worri": [9, 10], "about": [9, 10], "infra": 9, "automag": 9, "behind": [9, 10], "scene": [9, 10], "write": [9, 10], "algorthm": 9, "our": [9, 11, 12], "heurist": 9, "massiv": 9, "bank": 9, "intens": 9, "o": 9, "bandwidth": [9, 10], "latenc": [9, 10], "low": 9, "busi": 9, "plu": 9, "failur": [9, 10, 11], "cascad": [9, 11], "halt": 9, "entir": [9, 12], "failov": [9, 10], "wast": 9, "naive_rl_step": 9, "idl": 9, "policy_model": 9, "compute_loss": 9, "ineffici": 9, "everyth": 9, "policy_fail": 9, "reward_fail": 9, "trainer_fail": 9, "entire_system_stop": 9, "unit": 9, "easi": 9, "recoveri": [9, 10], "semant": 9, "notic": 9, "cover": 9, "send": [9, 10, 11], "balanc": 9, "fanout": [9, 11], "real_rl_training_step": 9, "cat": [9, 10], "unsqueez": [9, 10], "tupl": [9, 10], "line": [9, 10], "hidden": 9, "demand": 9, "replaybuff": [9, 10], "rltrainer": [9, 10], "computeadvantag": [9, 10], "mathreward": [9, 10], "thinkingreward": [9, 10], "asyncio": [9, 10, 11], "qwen": [9, 10, 11], "group_siz": 9, "compute_advantag": [9, 10], "openai": [9, 10], "gsm8k": [9, 10], "revis": [9, 10], "data_split": [9, 10], "stream": 9, "engine_config": [9, 10], "tensor_parallel_s": [9, 10], "pipeline_parallel_s": [9, 10], "enforce_eag": [9, 10], "sampling_config": [9, 10], "max_token": [9, 10], "16": [9, 10], "temperatur": [9, 10], "top_p": [9, 10], "come": [9, 10, 12], "max_policy_ag": [9, 10], "dp_size": [9, 10], "reward_funct": [9, 10], "two": 9, "intern": [9, 10, 11, 12], "distinct": 9, "explain": [9, 10, 12], "respawn": 9, "background": 9, "impact": [9, 10, 11], "grace": 9, "applic": [9, 11], "monolith": 9, "go": [9, 10], "deeper": [9, 12], "forgeservic": 9, "highli": 10, "concept": [10, 11], "thei": [10, 11], "land": 10, "hood": 10, "grab": [10, 12], "chai": [10, 12], "policy_servic": 10, "don": [10, 11], "right": 10, "serviceconfig": 10, "remot": [10, 11], "serial": 10, "done": 10, "serviceactor": [10, 11], "serviceinterfac": 10, "adverb": 10, "normal": 10, "extract": 10, "fail": [10, 11], "pick": 10, "round": 10, "robin": 10, "characterist": 10, "lowest": 10, "network": 10, "hop": 10, "capac": 10, "critic": 10, "choic": 10, "stateless": 10, "current_vers": 10, "version_replica_1": 10, "version_replica_2": 10, "new_policy_vers": 10, "simultan": 10, "unless": 10, "gotcha": 10, "contact": 10, "arriv": 10, "els": 10, "sleep": 10, "much": 10, "hit": 10, "preserv": [10, 11], "sticki": 10, "counter": [10, 11], "demonstr": 10, "between": 10, "regular": 10, "forgecount": 10, "__init__": [10, 11], "self": [10, 11], "initial_valu": [10, 11], "int": [10, 11], "increment": [10, 11], "get_valu": [10, 11], "reset": 10, "counter_servic": 10, "goe": [10, 12], "might": 10, "inconsist": 10, "WITH": 10, "nuse": 10, "final_valu": 10, "turn": 10, "response1": 10, "turn1": 10, "full_prompt": 10, "turn2": 10, "response2": 10, "both": 10, "maxim": 10, "ti": 10, "histori": 10, "break": 10, "naive_multi_turn": 10, "miss": 10, "question1": 10, "response3": 10, "conversation_so_far": 10, "optimized_multi_turn": 10, "guarante": 10, "reus": 10, "recomput": 10, "collector": 10, "concurr": 10, "thread": 10, "clarifi": 10, "singleton": 10, "step_numb": 10, "evict": 10, "old": 10, "state_dict": 10, "safeti": 10, "sequenti": 10, "those": 10, "real_weight_sync": 10, "push": 10, "policy_vers": 10, "simple_rl_step": 10, "correct": 10, "field": 10, "action": 10, "episode_id": 10, "pad_id": 10, "pad_token_id": 10, "request_len": 10, "response_len": 10, "request_token": 10, "tolist": 10, "response_token": 10, "dimens": 10, "new_group": 10, "rang": 10, "4f": 10, "independ": [10, 11], "model_nam": 10, "fewer": 10, "heavi": 10, "float": 10, "total_reward": 10, "reward_fn": 10, "len": 10, "240": 10, "36": 10, "around": 10, "322": 10, "344": 10, "successfulli": 10, "production_training_loop": 10, "create_episode_from_grpo_data": 10, "observ": 10, "seri": 11, "peel": [11, 12], "back": [11, 12], "crucial": 11, "abstract": [11, 12], "organ": 11, "think": 11, "dimension": 11, "grid": 11, "topologi": 11, "per_host": 11, "7": 11, "beauti": 11, "seamlessli": 11, "cluster_proc": 11, "spawn_cluster_proc": 11, "host1": 11, "host2": 11, "host3": 11, "stai": 11, "100": 11, "my_actor": 11, "myactor": 11, "educ": 11, "this_proc": 11, "defin": 11, "fut": 11, "One": 11, "random": 11, "fire": 11, "forget": 11, "rememb": [11, 12], "raw": 11, "policy_actor": 11, "isol": 11, "transpar": 11, "ident": 11, "race": 11, "condit": 11, "lock": 11, "hide": 11, "gracefulli": 11, "recov": 11, "fundament": [11, 12], "know": 11, "spawn_servic": 11, "ml": 12, "mention": 12, "welcom": 12, "inspir": 12, "z": 12, "shoutout": 12, "friend": 12, "part": 12, "terminologi": 12, "refresh": 12, "teach": 12, "connect": 12, "101": 12, "talk": 12, "upon": 12, "consum": 12, "roughli": 12, "hour": 12, "enjoi": 12, "eager": 12, "checkout": 12}, "objects": {"forge.actors.generator": [[2, 0, 1, "", "Generator"], [2, 0, 1, "", "GeneratorWorker"]], "forge.actors.generator.Generator": [[2, 1, 1, "", "engine_args"], [2, 1, 1, "", "generate"], [2, 1, 1, "", "get_version"], [2, 1, 1, "", "get_vllm_config"], [2, 1, 1, "", "n_fetcher_procs"], [2, 1, 1, "", "prefetch_weights_to_shm"], [2, 1, 1, "", "register_worker"], [2, 2, 1, "", "run"], [2, 1, 1, "", "sampling_params"], [2, 1, 1, "", "setup"], [2, 2, 1, "", "shutdown"], [2, 1, 1, "", "stop"], [2, 1, 1, "", "update_weights"], [2, 1, 1, "", "use_dcp_for_weight_sync"]], "forge.actors.generator.GeneratorWorker": [[2, 1, 1, "", "execute_model"], [2, 1, 1, "", "setup"], [2, 1, 1, "", "setup_kv_cache"], [2, 1, 1, "", "update_weights"], [2, 1, 1, "", "vllm_config"]], "forge.actors.reference_model": [[3, 0, 1, "", "ReferenceModel"]], "forge.actors.reference_model.ReferenceModel": [[3, 1, 1, "", "checkpoint"], [3, 1, 1, "", "comm"], [3, 1, 1, "", "compile"], [3, 1, 1, "", "forward"], [3, 1, 1, "", "model"], [3, 1, 1, "", "parallelism"], [3, 1, 1, "", "setup"], [3, 1, 1, "", "training"]], "forge.actors.trainer": [[5, 0, 1, "", "RLTrainer"]], "forge.actors.trainer.RLTrainer": [[5, 1, 1, "", "activation_checkpoint"], [5, 1, 1, "", "checkpoint"], [5, 1, 1, "", "cleanup"], [5, 1, 1, "", "comm"], [5, 1, 1, "", "compile"], [5, 1, 1, "", "dcp_path"], [5, 2, 1, "", "forward_backward"], [5, 1, 1, "", "job"], [5, 2, 1, "", "loss"], [5, 1, 1, "", "lr_scheduler"], [5, 1, 1, "", "memory_estimation"], [5, 1, 1, "", "model"], [5, 1, 1, "", "optimizer"], [5, 1, 1, "", "parallelism"], [5, 1, 1, "", "push_weights"], [5, 1, 1, "", "quantize"], [5, 1, 1, "", "setup"], [5, 1, 1, "", "state_dict_key"], [5, 1, 1, "", "train_step"], [5, 1, 1, "", "training"], [5, 1, 1, "", "use_dcp"]], "forge.controller.actor": [[1, 0, 1, "", "ForgeActor"]], "forge.controller.actor.ForgeActor": [[1, 2, 1, "", "as_actor"], [1, 1, 1, "", "hosts"], [1, 2, 1, "", "launch"], [1, 1, 1, "", "mesh_name"], [1, 1, 1, "", "num_replicas"], [1, 2, 1, "", "options"], [1, 1, 1, "", "procs"], [1, 2, 1, "", "shutdown"], [1, 1, 1, "", "with_gpus"]], "forge.controller.service.service": [[4, 0, 1, "", "Service"]], "forge.controller.service.service.Service": [[4, 2, 1, "", "call_all"], [4, 2, 1, "", "get_metrics"], [4, 2, 1, "", "get_metrics_summary"], [4, 2, 1, "", "start_session"], [4, 2, 1, "", "stop"], [4, 2, 1, "", "terminate_session"]], "torchtitan.config.job_config": [[5, 0, 1, "", "Checkpoint"], [5, 0, 1, "", "Job"], [5, 0, 1, "", "Model"], [5, 0, 1, "", "Optimizer"], [5, 0, 1, "", "Parallelism"], [5, 0, 1, "", "Training"]], "torchtitan.config.job_config.Checkpoint": [[5, 1, 1, "", "async_mode"], [5, 1, 1, "", "create_seed_checkpoint"], [5, 1, 1, "", "enable"], [5, 1, 1, "", "enable_first_step_checkpoint"], [5, 1, 1, "", "exclude_from_loading"], [5, 1, 1, "", "export_dtype"], [5, 1, 1, "", "folder"], [5, 1, 1, "", "initial_load_in_hf"], [5, 1, 1, "", "initial_load_model_only"], [5, 1, 1, "", "initial_load_path"], [5, 1, 1, "", "interval"], [5, 1, 1, "", "keep_latest_k"], [5, 1, 1, "", "last_save_in_hf"], [5, 1, 1, "", "last_save_model_only"], [5, 1, 1, "", "load_step"]], "torchtitan.config.job_config.Job": [[5, 1, 1, "", "config_file"], [5, 1, 1, "", "description"], [5, 1, 1, "", "dump_folder"], [5, 1, 1, "", "print_args"]], "torchtitan.config.job_config.Model": [[5, 1, 1, "", "converters"], [5, 1, 1, "", "flavor"], [5, 1, 1, "", "hf_assets_path"], [5, 1, 1, "", "name"], [5, 1, 1, "", "print_after_conversion"], [5, 1, 1, "", "tokenizer_path"]], "torchtitan.config.job_config.Optimizer": [[5, 1, 1, "", "beta1"], [5, 1, 1, "", "beta2"], [5, 1, 1, "", "early_step_in_backward"], [5, 1, 1, "", "eps"], [5, 1, 1, "", "implementation"], [5, 1, 1, "", "lr"], [5, 1, 1, "", "name"], [5, 1, 1, "", "weight_decay"]], "torchtitan.config.job_config.Parallelism": [[5, 1, 1, "", "context_parallel_degree"], [5, 1, 1, "", "context_parallel_rotate_method"], [5, 1, 1, "", "data_parallel_replicate_degree"], [5, 1, 1, "", "data_parallel_shard_degree"], [5, 1, 1, "", "disable_loss_parallel"], [5, 1, 1, "", "enable_async_tensor_parallel"], [5, 1, 1, "", "enable_compiled_autograd"], [5, 1, 1, "", "expert_parallel_degree"], [5, 1, 1, "", "expert_tensor_parallel_degree"], [5, 1, 1, "", "fsdp_reshard_after_forward"], [5, 1, 1, "", "module_fqns_per_model_part"], [5, 1, 1, "", "pipeline_parallel_degree"], [5, 1, 1, "", "pipeline_parallel_first_stage_less_layers"], [5, 1, 1, "", "pipeline_parallel_last_stage_less_layers"], [5, 1, 1, "", "pipeline_parallel_layers_per_stage"], [5, 1, 1, "", "pipeline_parallel_microbatch_size"], [5, 1, 1, "", "pipeline_parallel_schedule"], [5, 1, 1, "", "pipeline_parallel_schedule_csv"], [5, 1, 1, "", "pipeline_parallel_split_points"], [5, 1, 1, "", "tensor_parallel_degree"]], "torchtitan.config.job_config.Training": [[5, 1, 1, "", "dataset"], [5, 1, 1, "", "dataset_path"], [5, 1, 1, "", "deterministic"], [5, 1, 1, "", "dtype"], [5, 1, 1, "", "enable_cpu_offload"], [5, 1, 1, "", "gc_debug"], [5, 1, 1, "", "gc_freq"], [5, 1, 1, "", "global_batch_size"], [5, 1, 1, "", "local_batch_size"], [5, 1, 1, "", "max_norm"], [5, 1, 1, "", "mixed_precision_param"], [5, 1, 1, "", "mixed_precision_reduce"], [5, 1, 1, "", "seed"], [5, 1, 1, "", "seq_len"], [5, 1, 1, "", "steps"]]}, "objtypes": {"0": "py:class", "1": "py:attribute", "2": "py:method"}, "objnames": {"0": ["py", "class", "Python class"], "1": ["py", "attribute", "Python attribute"], "2": ["py", "method", "Python method"]}, "titleterms": {"api": 0, "refer": [0, 10], "overview": 0, "forgeactor": 1, "gener": 2, "generatorwork": 2, "model": [3, 5], "referencemodel": 3, "servic": [4, 9, 10, 11], "trainer": 5, "rltrainer": 5, "configur": [5, 6, 10], "job": 5, "optim": 5, "train": [5, 6, 10], "parallel": 5, "checkpoint": 5, "get": 6, "start": 6, "system": 6, "requir": [6, 7], "prerequisit": 6, "instal": 6, "verifi": 6, "your": [6, 11], "setup": 6, "quick": [6, 10], "exampl": [6, 9, 10], "1": [6, 9, 10], "supervis": 6, "fine": 6, "tune": 6, "sft": 6, "2": [6, 9, 10], "grpo": 6, "understand": 6, "file": 6, "next": 6, "step": [6, 9], "help": 6, "addit": 6, "resourc": [6, 9], "torchforg": [7, 9, 10, 11, 12], "document": 7, "why": [7, 9, 11], "core": [7, 9], "design": 7, "principl": 7, "foundat": [7, 11], "The": [7, 9, 10, 11], "technologi": 7, "stack": 7, "what": [7, 9, 10, 11], "you": [7, 11], "can": 7, "build": 7, "glanc": 7, "write": 7, "rl": [7, 9, 12], "code": [7, 11], "path": 7, "valid": 7, "partnership": 7, "commun": [7, 10], "indic": 7, "tutori": [8, 12], "part": [9, 10, 11], "fundament": 9, "us": [9, 11], "terminologi": 9, "compon": [9, 10], "toi": 9, "teach": 9, "math": 9, "defin": 9, "name": 9, "learn": [9, 11], "flow": 9, "from": [9, 12], "concept": 9, "thi": [9, 11], "matter": [9, 11], "tradit": 9, "ml": 9, "infrastructur": [9, 11], "fail": 9, "challeng": 9, "problem": [9, 10], "differ": 9, "need": 9, "complex": 9, "interdepend": 9, "3": [9, 10, 11], "coordin": [9, 10], "enter": 9, "nativ": 9, "architectur": [9, 11], "make": 9, "power": 9, "automat": 9, "manag": [9, 10], "independ": 9, "scale": [9, 10, 12], "fault": 9, "toler": 9, "peel": 10, "back": 10, "abstract": 10, "ar": 10, "anatomi": 10, "beyond": 10, "interfac": 10, "deep": [10, 11], "dive": [10, 11], "real": 10, "creation": [10, 11], "how": [10, 11], "actual": 10, "work": 10, "pattern": 10, "rout": 10, "load": 10, "balanc": 10, "singl": [10, 11], "replica": 10, "fanout": 10, "broadcast": 10, "result": 10, "collect": 10, "stream": 10, "oper": 10, "custom": 10, "implement": [10, 12], "session": 10, "state": 10, "realiti": 10, "kv": 10, "cach": 10, "replai": 10, "buffer": 10, "consist": 10, "weight": 10, "synchron": 10, "strategi": 10, "asynchron": 10, "approach": 10, "let": 10, "handl": 10, "speed": 10, "mismatch": 10, "orchestr": 10, "loop": 10, "monarch": 11, "connect": 11, "complet": 11, "hierarchi": 11, "silicon": 11, "procmesh": 11, "host": 11, "multi": 11, "actor": 11, "mesh": 11, "run": 11, "distribut": 11, "process": 11, "call": 11, "execut": 11, "multipl": 11, "share": 11, "kei": 11, "insight": 11, "conclus": 11, "ve": 11, "takeawai": 11, "zero": 12, "theori": 12, "product": 12, "structur": 12}, "envversion": {"sphinx.domains.c": 3, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 9, "sphinx.domains.index": 1, "sphinx.domains.javascript": 3, "sphinx.domains.math": 2, "sphinx.domains.python": 4, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx_last_updated_by_git": 1, "sphinx.ext.intersphinx": 1, "sphinx.ext.viewcode": 1, "sphinx": 60}, "alltitles": {"API Reference": [[0, "api-reference"]], "Overview": [[0, "overview"]], "ForgeActor": [[1, "forgeactor"]], "Generator": [[2, "generator"], [2, "id1"]], "GeneratorWorker": [[2, "generatorworker"]], "Model": [[3, "model"]], "ReferenceModel": [[3, "referencemodel"]], "Service": [[4, "service"]], "Trainer": [[5, "trainer"]], "RLTrainer": [[5, "rltrainer"]], "Configuration": [[5, "configuration"]], "Job Configuration": [[5, "job-configuration"]], "Model Configuration": [[5, "model-configuration"]], "Optimizer Configuration": [[5, "optimizer-configuration"]], "Training Configuration": [[5, "training-configuration"]], "Parallelism Configuration": [[5, "parallelism-configuration"]], "Checkpoint Configuration": [[5, "checkpoint-configuration"]], "Getting Started": [[6, "getting-started"]], "System Requirements": [[6, "system-requirements"]], "Prerequisites": [[6, "prerequisites"]], "Installation": [[6, "installation"]], "Verifying Your Setup": [[6, "verifying-your-setup"]], "Quick Start Examples": [[6, "quick-start-examples"]], "Example 1: Supervised Fine-Tuning (SFT)": [[6, "example-1-supervised-fine-tuning-sft"]], "Example 2: GRPO Training": [[6, "example-2-grpo-training"]], "Understanding Configuration Files": [[6, "understanding-configuration-files"]], "Next Steps": [[6, "next-steps"]], "Getting Help": [[6, "getting-help"]], "Additional Resources": [[6, "additional-resources"]], "TorchForge Documentation": [[7, "torchforge-documentation"]], "Why TorchForge?": [[7, "why-torchforge"]], "Core Design Principles": [[7, "core-design-principles"]], "Foundation: The Technology Stack": [[7, "foundation-the-technology-stack"]], "What You Can Build": [[7, "what-you-can-build"]], "Requirements at a Glance": [[7, "requirements-at-a-glance"]], "Writing RL Code": [[7, "writing-rl-code"]], "Documentation Paths": [[7, "documentation-paths"]], "Validation & Partnerships": [[7, "validation-partnerships"]], "Community": [[7, "community"]], "Documentation": [[7, null]], "Indices": [[7, "indices"]], "Tutorials": [[8, "tutorials"]], "Part 1: RL Fundamentals - Using TorchForge Terminology": [[9, "part-1-rl-fundamentals-using-torchforge-terminology"]], "Core RL Components in TorchForge": [[9, "core-rl-components-in-torchforge"]], "The Toy Example: Teaching Math": [[9, "the-toy-example-teaching-math"]], "RL Components Defined (TorchForge Names)": [[9, "rl-components-defined-torchforge-names"]], "The RL Learning Flow": [[9, "the-rl-learning-flow"]], "From Concepts to TorchForge Services": [[9, "from-concepts-to-torchforge-services"]], "RL Step with TorchForge Services": [[9, "rl-step-with-torchforge-services"]], "Why This Matters: Traditional ML Infrastructure Fails": [[9, "why-this-matters-traditional-ml-infrastructure-fails"]], "The Infrastructure Challenge": [[9, "the-infrastructure-challenge"]], "Problem 1: Different Resource Needs": [[9, "problem-1-different-resource-needs"]], "Problem 2: Complex Interdependencies": [[9, "problem-2-complex-interdependencies"]], "Problem 3: The Coordination Challenge": [[9, "problem-3-the-coordination-challenge"]], "Enter TorchForge: RL-Native Architecture": [[9, "enter-torchforge-rl-native-architecture"]], "What Makes This Powerful": [[9, "what-makes-this-powerful"]], "Automatic Resource Management": [[9, "automatic-resource-management"]], "Independent Scaling": [[9, "independent-scaling"]], "Fault Tolerance": [[9, "fault-tolerance"]], "Part 2: Peeling Back the Abstraction - What Are Services?": [[10, "part-2-peeling-back-the-abstraction-what-are-services"]], "Service Anatomy: Beyond the Interface": [[10, "service-anatomy-beyond-the-interface"]], "Service Components Deep Dive": [[10, "service-components-deep-dive"]], "1. Real Service Configuration": [[10, "real-service-configuration"]], "2. Real Service Creation": [[10, "real-service-creation"]], "3. How Services Actually Work": [[10, "how-services-actually-work"]], "Communication Patterns: Quick Reference": [[10, "communication-patterns-quick-reference"]], "Deep Dive: Service Communication Patterns": [[10, "deep-dive-service-communication-patterns"]], "1. .route() - Load Balanced Single Replica": [[10, "route-load-balanced-single-replica"]], "2. .fanout() - Broadcast with Results Collection": [[10, "fanout-broadcast-with-results-collection"]], "3. Streaming Operations - Custom Implementation Pattern": [[10, "streaming-operations-custom-implementation-pattern"]], "3. Service Sessions for Stateful Operations": [[10, "service-sessions-for-stateful-operations"]], "Deep Dive: State Management Reality": [[10, "deep-dive-state-management-reality"]], "The KV Cache Problem": [[10, "the-kv-cache-problem"]], "Replay Buffer Consistency": [[10, "replay-buffer-consistency"]], "Weight Synchronization Strategy": [[10, "weight-synchronization-strategy"]], "Deep Dive: Asynchronous Coordination Patterns": [[10, "deep-dive-asynchronous-coordination-patterns"]], "The TorchForge Approach: Let Services Handle Coordination": [[10, "the-torchforge-approach-let-services-handle-coordination"]], "Handling Speed Mismatches with Service Scaling": [[10, "handling-speed-mismatches-with-service-scaling"]], "Service Implementation Example": [[10, "service-implementation-example"]], "Service Orchestration: The Training Loop": [[10, "service-orchestration-the-training-loop"]], "Part 3: The TorchForge-Monarch Connection": [[11, "part-3-the-torchforge-monarch-connection"]], "The Complete Hierarchy: Service to Silicon": [[11, "the-complete-hierarchy-service-to-silicon"]], "Deep Dive: ProcMesh - The Foundation": [[11, "deep-dive-procmesh-the-foundation"]], "Single Host ProcMesh": [[11, "single-host-procmesh"]], "Multi-Host ProcMesh": [[11, "multi-host-procmesh"]], "Actor Meshes: Your Code Running Distributed": [[11, "actor-meshes-your-code-running-distributed"]], "How TorchForge Services Use Monarch": [[11, "how-torchforge-services-use-monarch"]], "The Service Creation Process": [[11, "the-service-creation-process"]], "Service Call to Actor Execution": [[11, "service-call-to-actor-execution"]], "Multiple Services Sharing Infrastructure": [[11, "multiple-services-sharing-infrastructure"]], "Key Insights: Why This Architecture Matters": [[11, "key-insights-why-this-architecture-matters"]], "Conclusion": [[11, "conclusion"]], "What You\u2019ve Learned": [[11, "what-you-ve-learned"]], "Key Takeaways": [[11, "key-takeaways"]], "Zero to TorchForge: From RL Theory to Production-Scale Implementation": [[12, "zero-to-torchforge-from-rl-theory-to-production-scale-implementation"]], "Tutorial Structure": [[12, "tutorial-structure"]]}, "indexentries": {"forgeactor (class in forge.controller.actor)": [[1, "forge.controller.actor.ForgeActor"]], "as_actor() (forge.controller.actor.forgeactor class method)": [[1, "forge.controller.actor.ForgeActor.as_actor"]], "hosts (forge.controller.actor.forgeactor attribute)": [[1, "forge.controller.actor.ForgeActor.hosts"]], "launch() (forge.controller.actor.forgeactor class method)": [[1, "forge.controller.actor.ForgeActor.launch"]], "mesh_name (forge.controller.actor.forgeactor attribute)": [[1, "forge.controller.actor.ForgeActor.mesh_name"]], "num_replicas (forge.controller.actor.forgeactor attribute)": [[1, "forge.controller.actor.ForgeActor.num_replicas"]], "options() (forge.controller.actor.forgeactor class method)": [[1, "forge.controller.actor.ForgeActor.options"]], "procs (forge.controller.actor.forgeactor attribute)": [[1, "forge.controller.actor.ForgeActor.procs"]], "shutdown() (forge.controller.actor.forgeactor class method)": [[1, "forge.controller.actor.ForgeActor.shutdown"]], "with_gpus (forge.controller.actor.forgeactor attribute)": [[1, "forge.controller.actor.ForgeActor.with_gpus"]], "generator (class in forge.actors.generator)": [[2, "forge.actors.generator.Generator"]], "generatorworker (class in forge.actors.generator)": [[2, "forge.actors.generator.GeneratorWorker"]], "engine_args (forge.actors.generator.generator attribute)": [[2, "forge.actors.generator.Generator.engine_args"]], "execute_model (forge.actors.generator.generatorworker attribute)": [[2, "forge.actors.generator.GeneratorWorker.execute_model"]], "generate (forge.actors.generator.generator attribute)": [[2, "forge.actors.generator.Generator.generate"]], "get_version (forge.actors.generator.generator attribute)": [[2, "forge.actors.generator.Generator.get_version"]], "get_vllm_config (forge.actors.generator.generator attribute)": [[2, "forge.actors.generator.Generator.get_vllm_config"]], "n_fetcher_procs (forge.actors.generator.generator attribute)": [[2, "forge.actors.generator.Generator.n_fetcher_procs"]], "prefetch_weights_to_shm (forge.actors.generator.generator attribute)": [[2, "forge.actors.generator.Generator.prefetch_weights_to_shm"]], "register_worker (forge.actors.generator.generator attribute)": [[2, "forge.actors.generator.Generator.register_worker"]], "run() (forge.actors.generator.generator method)": [[2, "forge.actors.generator.Generator.run"]], "sampling_params (forge.actors.generator.generator attribute)": [[2, "forge.actors.generator.Generator.sampling_params"]], "setup (forge.actors.generator.generator attribute)": [[2, "forge.actors.generator.Generator.setup"]], "setup (forge.actors.generator.generatorworker attribute)": [[2, "forge.actors.generator.GeneratorWorker.setup"]], "setup_kv_cache (forge.actors.generator.generatorworker attribute)": [[2, "forge.actors.generator.GeneratorWorker.setup_kv_cache"]], "shutdown() (forge.actors.generator.generator class method)": [[2, "forge.actors.generator.Generator.shutdown"]], "stop (forge.actors.generator.generator attribute)": [[2, "forge.actors.generator.Generator.stop"]], "update_weights (forge.actors.generator.generator attribute)": [[2, "forge.actors.generator.Generator.update_weights"]], "update_weights (forge.actors.generator.generatorworker attribute)": [[2, "forge.actors.generator.GeneratorWorker.update_weights"]], "use_dcp_for_weight_sync (forge.actors.generator.generator attribute)": [[2, "forge.actors.generator.Generator.use_dcp_for_weight_sync"]], "vllm_config (forge.actors.generator.generatorworker attribute)": [[2, "forge.actors.generator.GeneratorWorker.vllm_config"]], "referencemodel (class in forge.actors.reference_model)": [[3, "forge.actors.reference_model.ReferenceModel"]], "checkpoint (forge.actors.reference_model.referencemodel attribute)": [[3, "forge.actors.reference_model.ReferenceModel.checkpoint"]], "comm (forge.actors.reference_model.referencemodel attribute)": [[3, "forge.actors.reference_model.ReferenceModel.comm"]], "compile (forge.actors.reference_model.referencemodel attribute)": [[3, "forge.actors.reference_model.ReferenceModel.compile"]], "forward (forge.actors.reference_model.referencemodel attribute)": [[3, "forge.actors.reference_model.ReferenceModel.forward"]], "model (forge.actors.reference_model.referencemodel attribute)": [[3, "forge.actors.reference_model.ReferenceModel.model"]], "parallelism (forge.actors.reference_model.referencemodel attribute)": [[3, "forge.actors.reference_model.ReferenceModel.parallelism"]], "setup (forge.actors.reference_model.referencemodel attribute)": [[3, "forge.actors.reference_model.ReferenceModel.setup"]], "training (forge.actors.reference_model.referencemodel attribute)": [[3, "forge.actors.reference_model.ReferenceModel.training"]], "service (class in forge.controller.service.service)": [[4, "forge.controller.service.service.Service"]], "call_all() (forge.controller.service.service.service method)": [[4, "forge.controller.service.service.Service.call_all"]], "get_metrics() (forge.controller.service.service.service method)": [[4, "forge.controller.service.service.Service.get_metrics"]], "get_metrics_summary() (forge.controller.service.service.service method)": [[4, "forge.controller.service.service.Service.get_metrics_summary"]], "start_session() (forge.controller.service.service.service method)": [[4, "forge.controller.service.service.Service.start_session"]], "stop() (forge.controller.service.service.service method)": [[4, "forge.controller.service.service.Service.stop"]], "terminate_session() (forge.controller.service.service.service method)": [[4, "forge.controller.service.service.Service.terminate_session"]], "checkpoint (class in torchtitan.config.job_config)": [[5, "torchtitan.config.job_config.Checkpoint"]], "job (class in torchtitan.config.job_config)": [[5, "torchtitan.config.job_config.Job"]], "model (class in torchtitan.config.job_config)": [[5, "torchtitan.config.job_config.Model"]], "optimizer (class in torchtitan.config.job_config)": [[5, "torchtitan.config.job_config.Optimizer"]], "parallelism (class in torchtitan.config.job_config)": [[5, "torchtitan.config.job_config.Parallelism"]], "rltrainer (class in forge.actors.trainer)": [[5, "forge.actors.trainer.RLTrainer"]], "training (class in torchtitan.config.job_config)": [[5, "torchtitan.config.job_config.Training"]], "activation_checkpoint (forge.actors.trainer.rltrainer attribute)": [[5, "forge.actors.trainer.RLTrainer.activation_checkpoint"]], "async_mode (torchtitan.config.job_config.checkpoint attribute)": [[5, "torchtitan.config.job_config.Checkpoint.async_mode"]], "beta1 (torchtitan.config.job_config.optimizer attribute)": [[5, "torchtitan.config.job_config.Optimizer.beta1"]], "beta2 (torchtitan.config.job_config.optimizer attribute)": [[5, "torchtitan.config.job_config.Optimizer.beta2"]], "checkpoint (forge.actors.trainer.rltrainer attribute)": [[5, "forge.actors.trainer.RLTrainer.checkpoint"]], "cleanup (forge.actors.trainer.rltrainer attribute)": [[5, "forge.actors.trainer.RLTrainer.cleanup"]], "comm (forge.actors.trainer.rltrainer attribute)": [[5, "forge.actors.trainer.RLTrainer.comm"]], "compile (forge.actors.trainer.rltrainer attribute)": [[5, "forge.actors.trainer.RLTrainer.compile"]], "config_file (torchtitan.config.job_config.job attribute)": [[5, "torchtitan.config.job_config.Job.config_file"]], "context_parallel_degree (torchtitan.config.job_config.parallelism attribute)": [[5, "torchtitan.config.job_config.Parallelism.context_parallel_degree"]], "context_parallel_rotate_method (torchtitan.config.job_config.parallelism attribute)": [[5, "torchtitan.config.job_config.Parallelism.context_parallel_rotate_method"]], "converters (torchtitan.config.job_config.model attribute)": [[5, "torchtitan.config.job_config.Model.converters"]], "create_seed_checkpoint (torchtitan.config.job_config.checkpoint attribute)": [[5, "torchtitan.config.job_config.Checkpoint.create_seed_checkpoint"]], "data_parallel_replicate_degree (torchtitan.config.job_config.parallelism attribute)": [[5, "torchtitan.config.job_config.Parallelism.data_parallel_replicate_degree"]], "data_parallel_shard_degree (torchtitan.config.job_config.parallelism attribute)": [[5, "torchtitan.config.job_config.Parallelism.data_parallel_shard_degree"]], "dataset (torchtitan.config.job_config.training attribute)": [[5, "torchtitan.config.job_config.Training.dataset"]], "dataset_path (torchtitan.config.job_config.training attribute)": [[5, "torchtitan.config.job_config.Training.dataset_path"]], "dcp_path (forge.actors.trainer.rltrainer attribute)": [[5, "forge.actors.trainer.RLTrainer.dcp_path"]], "description (torchtitan.config.job_config.job attribute)": [[5, "torchtitan.config.job_config.Job.description"]], "deterministic (torchtitan.config.job_config.training attribute)": [[5, "torchtitan.config.job_config.Training.deterministic"]], "disable_loss_parallel (torchtitan.config.job_config.parallelism attribute)": [[5, "torchtitan.config.job_config.Parallelism.disable_loss_parallel"]], "dtype (torchtitan.config.job_config.training attribute)": [[5, "torchtitan.config.job_config.Training.dtype"]], "dump_folder (torchtitan.config.job_config.job attribute)": [[5, "torchtitan.config.job_config.Job.dump_folder"]], "early_step_in_backward (torchtitan.config.job_config.optimizer attribute)": [[5, "torchtitan.config.job_config.Optimizer.early_step_in_backward"]], "enable (torchtitan.config.job_config.checkpoint attribute)": [[5, "torchtitan.config.job_config.Checkpoint.enable"]], "enable_async_tensor_parallel (torchtitan.config.job_config.parallelism attribute)": [[5, "torchtitan.config.job_config.Parallelism.enable_async_tensor_parallel"]], "enable_compiled_autograd (torchtitan.config.job_config.parallelism attribute)": [[5, "torchtitan.config.job_config.Parallelism.enable_compiled_autograd"]], "enable_cpu_offload (torchtitan.config.job_config.training attribute)": [[5, "torchtitan.config.job_config.Training.enable_cpu_offload"]], "enable_first_step_checkpoint (torchtitan.config.job_config.checkpoint attribute)": [[5, "torchtitan.config.job_config.Checkpoint.enable_first_step_checkpoint"]], "eps (torchtitan.config.job_config.optimizer attribute)": [[5, "torchtitan.config.job_config.Optimizer.eps"]], "exclude_from_loading (torchtitan.config.job_config.checkpoint attribute)": [[5, "torchtitan.config.job_config.Checkpoint.exclude_from_loading"]], "expert_parallel_degree (torchtitan.config.job_config.parallelism attribute)": [[5, "torchtitan.config.job_config.Parallelism.expert_parallel_degree"]], "expert_tensor_parallel_degree (torchtitan.config.job_config.parallelism attribute)": [[5, "torchtitan.config.job_config.Parallelism.expert_tensor_parallel_degree"]], "export_dtype (torchtitan.config.job_config.checkpoint attribute)": [[5, "torchtitan.config.job_config.Checkpoint.export_dtype"]], "flavor (torchtitan.config.job_config.model attribute)": [[5, "torchtitan.config.job_config.Model.flavor"]], "folder (torchtitan.config.job_config.checkpoint attribute)": [[5, "torchtitan.config.job_config.Checkpoint.folder"]], "forward_backward() (forge.actors.trainer.rltrainer method)": [[5, "forge.actors.trainer.RLTrainer.forward_backward"]], "fsdp_reshard_after_forward (torchtitan.config.job_config.parallelism attribute)": [[5, "torchtitan.config.job_config.Parallelism.fsdp_reshard_after_forward"]], "gc_debug (torchtitan.config.job_config.training attribute)": [[5, "torchtitan.config.job_config.Training.gc_debug"]], "gc_freq (torchtitan.config.job_config.training attribute)": [[5, "torchtitan.config.job_config.Training.gc_freq"]], "global_batch_size (torchtitan.config.job_config.training attribute)": [[5, "torchtitan.config.job_config.Training.global_batch_size"]], "hf_assets_path (torchtitan.config.job_config.model attribute)": [[5, "torchtitan.config.job_config.Model.hf_assets_path"]], "implementation (torchtitan.config.job_config.optimizer attribute)": [[5, "torchtitan.config.job_config.Optimizer.implementation"]], "initial_load_in_hf (torchtitan.config.job_config.checkpoint attribute)": [[5, "torchtitan.config.job_config.Checkpoint.initial_load_in_hf"]], "initial_load_model_only (torchtitan.config.job_config.checkpoint attribute)": [[5, "torchtitan.config.job_config.Checkpoint.initial_load_model_only"]], "initial_load_path (torchtitan.config.job_config.checkpoint attribute)": [[5, "torchtitan.config.job_config.Checkpoint.initial_load_path"]], "interval (torchtitan.config.job_config.checkpoint attribute)": [[5, "torchtitan.config.job_config.Checkpoint.interval"]], "job (forge.actors.trainer.rltrainer attribute)": [[5, "forge.actors.trainer.RLTrainer.job"]], "keep_latest_k (torchtitan.config.job_config.checkpoint attribute)": [[5, "torchtitan.config.job_config.Checkpoint.keep_latest_k"]], "last_save_in_hf (torchtitan.config.job_config.checkpoint attribute)": [[5, "torchtitan.config.job_config.Checkpoint.last_save_in_hf"]], "last_save_model_only (torchtitan.config.job_config.checkpoint attribute)": [[5, "torchtitan.config.job_config.Checkpoint.last_save_model_only"]], "load_step (torchtitan.config.job_config.checkpoint attribute)": [[5, "torchtitan.config.job_config.Checkpoint.load_step"]], "local_batch_size (torchtitan.config.job_config.training attribute)": [[5, "torchtitan.config.job_config.Training.local_batch_size"]], "loss() (forge.actors.trainer.rltrainer method)": [[5, "forge.actors.trainer.RLTrainer.loss"]], "lr (torchtitan.config.job_config.optimizer attribute)": [[5, "torchtitan.config.job_config.Optimizer.lr"]], "lr_scheduler (forge.actors.trainer.rltrainer attribute)": [[5, "forge.actors.trainer.RLTrainer.lr_scheduler"]], "max_norm (torchtitan.config.job_config.training attribute)": [[5, "torchtitan.config.job_config.Training.max_norm"]], "memory_estimation (forge.actors.trainer.rltrainer attribute)": [[5, "forge.actors.trainer.RLTrainer.memory_estimation"]], "mixed_precision_param (torchtitan.config.job_config.training attribute)": [[5, "torchtitan.config.job_config.Training.mixed_precision_param"]], "mixed_precision_reduce (torchtitan.config.job_config.training attribute)": [[5, "torchtitan.config.job_config.Training.mixed_precision_reduce"]], "model (forge.actors.trainer.rltrainer attribute)": [[5, "forge.actors.trainer.RLTrainer.model"]], "module_fqns_per_model_part (torchtitan.config.job_config.parallelism attribute)": [[5, "torchtitan.config.job_config.Parallelism.module_fqns_per_model_part"]], "name (torchtitan.config.job_config.model attribute)": [[5, "torchtitan.config.job_config.Model.name"]], "name (torchtitan.config.job_config.optimizer attribute)": [[5, "torchtitan.config.job_config.Optimizer.name"]], "optimizer (forge.actors.trainer.rltrainer attribute)": [[5, "forge.actors.trainer.RLTrainer.optimizer"]], "parallelism (forge.actors.trainer.rltrainer attribute)": [[5, "forge.actors.trainer.RLTrainer.parallelism"]], "pipeline_parallel_degree (torchtitan.config.job_config.parallelism attribute)": [[5, "torchtitan.config.job_config.Parallelism.pipeline_parallel_degree"]], "pipeline_parallel_first_stage_less_layers (torchtitan.config.job_config.parallelism attribute)": [[5, "torchtitan.config.job_config.Parallelism.pipeline_parallel_first_stage_less_layers"]], "pipeline_parallel_last_stage_less_layers (torchtitan.config.job_config.parallelism attribute)": [[5, "torchtitan.config.job_config.Parallelism.pipeline_parallel_last_stage_less_layers"]], "pipeline_parallel_layers_per_stage (torchtitan.config.job_config.parallelism attribute)": [[5, "torchtitan.config.job_config.Parallelism.pipeline_parallel_layers_per_stage"]], "pipeline_parallel_microbatch_size (torchtitan.config.job_config.parallelism attribute)": [[5, "torchtitan.config.job_config.Parallelism.pipeline_parallel_microbatch_size"]], "pipeline_parallel_schedule (torchtitan.config.job_config.parallelism attribute)": [[5, "torchtitan.config.job_config.Parallelism.pipeline_parallel_schedule"]], "pipeline_parallel_schedule_csv (torchtitan.config.job_config.parallelism attribute)": [[5, "torchtitan.config.job_config.Parallelism.pipeline_parallel_schedule_csv"]], "pipeline_parallel_split_points (torchtitan.config.job_config.parallelism attribute)": [[5, "torchtitan.config.job_config.Parallelism.pipeline_parallel_split_points"]], "print_after_conversion (torchtitan.config.job_config.model attribute)": [[5, "torchtitan.config.job_config.Model.print_after_conversion"]], "print_args (torchtitan.config.job_config.job attribute)": [[5, "torchtitan.config.job_config.Job.print_args"]], "push_weights (forge.actors.trainer.rltrainer attribute)": [[5, "forge.actors.trainer.RLTrainer.push_weights"]], "quantize (forge.actors.trainer.rltrainer attribute)": [[5, "forge.actors.trainer.RLTrainer.quantize"]], "seed (torchtitan.config.job_config.training attribute)": [[5, "torchtitan.config.job_config.Training.seed"]], "seq_len (torchtitan.config.job_config.training attribute)": [[5, "torchtitan.config.job_config.Training.seq_len"]], "setup (forge.actors.trainer.rltrainer attribute)": [[5, "forge.actors.trainer.RLTrainer.setup"]], "state_dict_key (forge.actors.trainer.rltrainer attribute)": [[5, "forge.actors.trainer.RLTrainer.state_dict_key"]], "steps (torchtitan.config.job_config.training attribute)": [[5, "torchtitan.config.job_config.Training.steps"]], "tensor_parallel_degree (torchtitan.config.job_config.parallelism attribute)": [[5, "torchtitan.config.job_config.Parallelism.tensor_parallel_degree"]], "tokenizer_path (torchtitan.config.job_config.model attribute)": [[5, "torchtitan.config.job_config.Model.tokenizer_path"]], "train_step (forge.actors.trainer.rltrainer attribute)": [[5, "forge.actors.trainer.RLTrainer.train_step"]], "training (forge.actors.trainer.rltrainer attribute)": [[5, "forge.actors.trainer.RLTrainer.training"]], "use_dcp (forge.actors.trainer.rltrainer attribute)": [[5, "forge.actors.trainer.RLTrainer.use_dcp"]], "weight_decay (torchtitan.config.job_config.optimizer attribute)": [[5, "torchtitan.config.job_config.Optimizer.weight_decay"]]}})