Search.setIndex({"docnames": ["api", "api_actors", "api_generator", "api_model", "api_service", "api_trainer", "concepts", "getting_started", "index", "tutorials", "tutorials/zero-to-forge/1_RL_and_Forge_Fundamentals", "tutorials/zero-to-forge/2_Forge_Internals", "tutorials/zero-to-forge/3_Monarch_101", "zero-to-forge-intro"], "filenames": ["api.md", "api_actors.md", "api_generator.md", "api_model.md", "api_service.md", "api_trainer.md", "concepts.md", "getting_started.md", "index.md", "tutorials.md", "tutorials/zero-to-forge/1_RL_and_Forge_Fundamentals.md", "tutorials/zero-to-forge/2_Forge_Internals.md", "tutorials/zero-to-forge/3_Monarch_101.md", "zero-to-forge-intro.md"], "titles": ["API Reference", "ForgeActor", "Generator", "Model", "Service", "Trainer", "Concepts", "Get Started", "Welcome to TorchForge documentation!", "Tutorials", "Part 1: RL Fundamentals - Using TorchForge Terminology", "Part 2: Peeling Back the Abstraction - What Are Services?", "Part 3: The TorchForge-Monarch Connection", "Zero to TorchForge: From RL Theory to Production-Scale Implementation"], "terms": {"thi": [0, 1, 2, 3, 4, 5, 6, 7, 9, 11, 13], "section": [0, 9, 10, 11, 12, 13], "provid": [0, 1, 3, 4, 5, 9, 10, 11], "comprehens": [0, 4, 13], "document": [0, 3, 5], "torchforg": [0, 1, 2, 5, 6, 7, 9], "i": [0, 1, 2, 3, 4, 5, 8, 10, 11, 12, 13], "pytorch": [0, 5, 7, 8, 12, 13], "nativ": [0, 7, 8], "platform": [0, 7, 8], "post": [0, 7, 8], "train": [0, 1, 3, 7, 8, 9, 10], "gener": [0, 1, 5, 7, 8, 10, 11], "ai": [0, 7, 8, 10], "model": [0, 1, 2, 7, 8, 9, 10, 11, 12, 13], "design": [0, 2, 7, 8], "streamlin": 0, "reinforc": [0, 1, 2, 3, 5, 7, 13], "learn": [0, 1, 2, 3, 5, 7, 11, 13], "workflow": [0, 1, 2, 5], "larg": [0, 7, 10], "languag": [0, 7, 13], "The": [0, 1, 2, 3, 4, 5], "leverag": 0, "": [0, 1, 2, 3, 4, 5, 9, 10, 11, 12, 13], "distribut": [0, 1, 3, 5, 7, 8, 9, 10, 11, 13], "comput": [0, 3, 5, 10, 11], "capabl": [0, 9], "built": [0, 1, 2, 5, 8, 11, 12], "top": [0, 2, 5, 12], "monarch": [0, 2, 8, 11, 13], "make": [0, 2], "extens": 0, "us": [0, 1, 2, 3, 4, 5, 6, 7, 11], "actor": [0, 1, 2, 3, 4, 5, 10, 11], "fault": [0, 11], "toler": [0, 11], "kei": [0, 4, 5, 10, 11], "featur": [0, 5], "includ": [0, 4, 5, 7, 8], "base": [0, 1, 2, 3, 5, 10, 11], "architectur": [0, 3, 6], "an": [0, 1, 4, 5, 10, 11, 13], "system": [0, 1, 3, 5, 6, 10, 11, 12, 13], "excel": 0, "scalabl": 0, "ensur": [0, 5, 11], "seamless": 0, "integr": [0, 8], "exist": [0, 5], "focu": [0, 8, 10], "specif": [0, 4, 5, 7, 8, 11, 12], "techniqu": [0, 7, 8], "like": [0, 1, 5, 8, 10, 11, 12], "rlvr": 0, "sft": [0, 7, 8, 13], "other": [0, 1, 2, 3, 5, 10, 11], "align": [0, 7], "method": [0, 1, 3, 4, 5, 11, 12], "support": [0, 5, 8], "multi": [0, 7, 8, 11], "gpu": [0, 1, 4, 5, 7, 8, 10, 11, 12], "node": [0, 7], "out": 0, "box": 0, "For": [0, 3, 5, 11], "most": [0, 5, 11], "case": [0, 5], "you": [0, 1, 5, 6, 7, 9, 10, 11, 13], "ll": [0, 10], "interact": [0, 10], "high": [0, 10, 11], "level": [0, 10, 12], "servic": [0, 1], "interfac": [0, 10], "which": [0, 4, 5, 12], "handl": [0, 4, 5, 10, 12], "complex": [0, 1, 11, 12], "coordin": 0, "automat": [0, 1, 4, 5, 11, 12], "advanc": [0, 7, 9], "user": [0, 5], "who": 0, "need": [0, 1, 4, 5, 11], "fine": [0, 7, 8, 9], "grain": 0, "control": [0, 1, 2, 4, 5, 11], "individu": [0, 12], "direct": 0, "access": 0, "underli": [0, 12], "compon": [0, 1, 5, 6], "forgeactor": [0, 2, 3, 11, 12], "trainer": [0, 10, 11], "modul": [1, 5, 8], "contain": [1, 5], "core": [1, 2, 12], "infer": [1, 2, 3, 5, 10, 11], "These": [1, 11], "pre": [1, 5, 7, 8], "essenti": [1, 11], "function": [1, 4, 5, 11, 12], "can": [1, 5, 10, 11, 12, 13], "build": [1, 11, 13], "block": [1, 11], "class": [1, 2, 3, 4, 5, 11, 12], "forg": [1, 2, 3, 4, 5, 10, 11], "arg": [1, 4, 5], "kwarg": [1, 4], "sourc": [1, 2, 3, 4, 5, 11, 12], "configur": [1, 3, 4, 8], "resourc": [1, 4, 11, 12], "attribut": 1, "initi": [1, 5, 11, 12], "set": [1, 3, 5], "up": [1, 4, 5, 7], "log": [1, 3, 4], "rank": [1, 5], "size": [1, 3, 5, 10], "inform": [1, 4], "process": [1, 5, 10, 11], "mesh": [1, 2], "refer": [1, 3, 5, 8, 10, 13], "ar": [1, 2, 4, 5, 10, 12], "determin": [1, 11], "from": [1, 3, 4, 5, 9, 11, 12], "current": [1, 5, 11, 13], "execut": [1, 2], "context": [1, 5, 11], "paramet": [1, 2, 4, 5, 11, 12], "variabl": [1, 3], "length": [1, 5], "argument": [1, 2, 4, 5, 12], "list": [1, 4, 5, 10, 11], "pass": [1, 3, 4, 5, 12], "parent": 1, "arbitrari": 1, "keyword": [1, 4], "async": [1, 2, 4, 5, 10, 11, 12], "classmethod": [1, 2], "as_actor": [1, 10, 11, 12], "actor_kwarg": [1, 4], "spawn": [1, 11, 12], "singl": [1, 5, 10], "store": [1, 5, 10, 11], "option": [1, 2, 3, 5, 10, 11, 12], "default": [1, 2, 5, 11], "valu": [1, 5, 11, 12], "subclass": 1, "return": [1, 2, 3, 4, 5, 10, 11, 12], "proc": [1, 2, 10, 11, 12], "construct": 1, "processconfig": 1, "instanc": [1, 2, 5, 10, 11, 12], "If": [1, 2, 4, 5, 10, 13], "wa": 1, "type": [1, 2, 4, 5, 10], "typevar": 1, "t": [1, 5, 11, 12], "bound": [1, 11], "host": [1, 11], "none": [1, 2, 5, 10, 11, 12], "number": [1, 4, 5, 11, 12], "across": [1, 5, 7, 11, 12], "mani": [1, 5, 11, 12], "accommod": 1, "request": [1, 4, 10, 11], "launch": 1, "provis": 1, "deploi": 1, "new": [1, 4, 5, 11], "replica": [1, 4, 10, 12], "we": [1, 5, 10, 11, 12], "implement": [1, 4, 5, 9, 10], "wai": [1, 5, 11], "becaus": [1, 5], "special": [1, 7, 8], "server": 1, "mai": [1, 5, 10], "compos": 1, "multipl": [1, 7, 10, 11], "allow": [1, 5], "specifi": [1, 5], "how": [1, 5, 6, 10, 13], "your": [1, 10, 11], "get": [1, 2, 4, 8, 10, 11, 12], "togeth": [1, 10], "basic": [1, 9, 11, 12], "assum": [1, 11], "re": [1, 13], "homogen": 1, "actormesh": [1, 11, 12], "mesh_nam": 1, "name": [1, 4, 5, 11], "num_replica": [1, 2, 10, 11], "1": [1, 2, 5, 8, 12], "creat": [1, 5, 10, 11, 12], "when": [1, 4, 5, 10, 11, 12], "onli": [1, 3, 5, 12], "appli": [1, 5], "as_servic": [1, 2, 10, 11, 12], "with_gpu": [1, 2, 10, 11], "fals": [1, 5, 10, 11], "version": [1, 11], "befor": [1, 11], "each": [1, 4, 5, 10, 11, 12, 13], "call": [1, 2, 4, 5, 10, 11], "separ": [1, 5, 12], "so": 1, "differ": [1, 2, 5, 11, 12], "coexist": 1, "without": [1, 3, 5, 11, 12], "interf": 1, "exampl": [1, 2, 4, 5, 12, 13], "rtype": 1, "await": [1, 2, 4, 10, 11, 12], "myforgeactor": 1, "2": [1, 5, 12], "shutdown": [1, 2, 11], "usag": [1, 5, 10, 11, 12], "shut": [1, 11], "down": [1, 11], "teardown": 1, "whether": [1, 2, 5, 12], "alloc": [1, 11], "polici": [2, 3, 5, 7, 8, 10, 11, 12], "engin": [2, 3, 5, 13], "vllm": [2, 8], "It": [2, 3, 5, 13], "manag": [2, 4, 5, 12], "serv": [2, 3, 12], "text": [2, 10, 11], "weight": [2, 5, 10], "updat": [2, 4, 5, 10, 11], "engine_arg": 2, "factori": [2, 3, 5], "sampling_param": 2, "use_dcp_for_weight_sync": 2, "manual": [2, 5, 11], "recreat": 2, "mirror": 2, "asyncllmengin": 2, "v1": 2, "main": [2, 10, 11], "all": [2, 4, 5, 10, 11, 12], "commun": [2, 3, 5, 10, 12], "here": [2, 5, 10, 11], "via": [2, 5], "enginearg": 2, "samplingparam": 2, "sampl": [2, 10, 11], "bool": 2, "dcp": [2, 5], "nf": 2, "sync": 2, "depend": [2, 8], "rdma": 2, "enabl": [2, 3, 4, 5], "torchstor": [2, 11], "disabl": [2, 4, 5], "otherwis": [2, 5, 11], "true": [2, 5, 10, 11], "tell": 2, "me": 2, "joke": 2, "complet": [2, 4, 5, 10, 11], "prompt": [2, 10, 11], "A": [2, 3, 5, 11, 13], "why": 2, "did": [2, 10], "chicken": 2, "cross": [2, 12], "road": 2, "b": 2, "To": 2, "side": 2, "token_id": [2, 10, 11], "logprob": [2, 10], "get_vers": [2, 11], "get_vllm_config": 2, "register_work": 2, "run": [2, 3, 5, 7, 11], "schedul": [2, 5], "output": [2, 5, 11, 12], "project": 2, "save_model_param": 2, "setup": [2, 3, 5, 8], "stop": [2, 4, 10, 12], "update_weight": [2, 10, 11], "validate_model_param": 2, "vllm_config": 2, "gpuwork": 2, "In": [2, 5, 10, 11, 12], "should": [2, 4, 5], "instanti": [2, 4], "directli": [2, 10, 12], "rather": 2, "creation": 2, "invoc": 2, "execute_model": 2, "setup_kv_cach": 2, "reference_model": [3, 10, 11], "frozen": 3, "copi": [3, 5, 10], "advantag": [3, 10, 11], "perform": [3, 4, 5, 11, 12], "input": [3, 5, 10, 11], "sequenc": [3, 5], "logit": [3, 5], "probabl": 3, "kl": [3, 5], "diverg": [3, 5], "rl": [3, 9, 11, 12], "metric": [3, 4], "parallel": [3, 10, 11], "checkpoint": [3, 11], "compil": [3, 5], "comm": [3, 5], "torchtitan": [3, 5, 8], "forward": [3, 5, 10, 11], "gradient": [3, 5], "typic": [3, 5, 11], "maintain": [3, 4, 11, 12], "algorithm": [3, 5], "consist": [3, 4], "optim": [3, 7, 8, 10, 11, 12], "grpo": [3, 5, 7, 8, 10, 11], "group": [3, 5, 7, 8, 11], "rel": [3, 5, 7, 8], "ppo": 3, "proxim": 3, "where": [3, 5, 10, 11, 12], "fix": 3, "point": [3, 5, 12], "penalti": [3, 5], "against": [3, 5], "load": [3, 4, 5, 10], "evalu": [3, 10, 11], "mode": [3, 5, 10], "inference_mod": 3, "memori": [3, 5, 10, 12], "effici": [3, 7, 11], "vocab": 3, "etc": [3, 5, 11, 12], "collect": [3, 5, 10, 12], "strategi": [3, 5, 10], "dp": [3, 5], "tp": [3, 5], "pp": [3, 5], "cp": [3, 5], "torch": [3, 5, 10, 11], "backend": 3, "relat": 3, "dtype": [3, 5, 10], "garbag": [3, 5, 11], "subset": 3, "dataclass": 3, "detail": [3, 4, 10, 13], "cfg": 4, "actor_def": 4, "actor_arg": 4, "less": 4, "temporari": [4, 5], "solut": [4, 11], "nest": 4, "prove": 4, "problemat": 4, "temporarili": 4, "per": [4, 5, 11, 12], "health": [4, 11], "poll": 4, "rate": [4, 5], "definit": [4, 5, 11], "posit": 4, "constructor": [4, 12], "member": 4, "call_al": 4, "start_sess": 4, "get_metr": 4, "get_metrics_summari": 4, "terminate_sess": 4, "show": [4, 12], "inherit": 4, "broadcast": [4, 12], "healthi": [4, 10, 11], "result": [4, 5, 12], "endpoint": [4, 11, 12], "rais": 4, "runtimeerror": 4, "avail": [4, 5, 11], "monitor": [4, 11], "analysi": 4, "data": [4, 5, 7, 10, 11], "wide": 4, "aggreg": 4, "statu": 4, "servicemetr": 4, "object": [4, 11], "print": [4, 5, 11, 12], "f": [4, 10, 11, 12], "get_total_request_r": 4, "1f": 4, "req": 4, "queue": 4, "depth": 4, "get_avg_queue_depth": 4, "summari": [4, 11], "debug": [4, 5, 12], "structur": [4, 10, 11, 12], "format": [4, 5], "suitabl": 4, "dashboard": 4, "purpos": [4, 12], "dict": [4, 5], "healthy_replica": 4, "idx": 4, "item": 4, "request_r": 4, "start": [4, 8, 10], "session": [4, 12], "state": [4, 5, 12], "affin": 4, "workload": 4, "requir": [4, 5, 8, 10, 11], "uniqu": 4, "id": 4, "assign": [4, 12], "least": [4, 10], "str": [4, 11], "identifi": 4, "subsequ": 4, "session_id": 4, "my_endpoint": 4, "arg1": 4, "arg2": 4, "longer": 4, "sess_id": 4, "termin": [4, 5], "activ": [4, 5], "clean": 4, "associ": 4, "remov": [4, 11], "track": 4, "clear": [4, 11], "free": 4, "backward": 5, "lr_schedul": 5, "activation_checkpoint": 5, "quantiz": 5, "memory_estim": 5, "loss": [5, 10, 11], "lambda": 5, "state_dict_kei": 5, "model_state_dict": 5, "use_dcp": 5, "dcp_path": 5, "forge_dcp_tmp": 5, "loop": [5, 10], "step": [5, 9, 11, 12], "unlik": [5, 10], "referencemodel": [5, 10, 11], "through": [5, 11], "descent": 5, "same": [5, 10, 11, 12], "doe": [5, 10], "limit": [5, 11], "tensor": [5, 10, 11], "fsdp": 5, "fulli": 5, "shard": [5, 10], "conjunct": 5, "propag": 5, "mix": [5, 10], "precis": 5, "amp": 5, "cleanup": [5, 11, 12], "forward_backward": 5, "target": [5, 10, 11], "push_weight": [5, 10, 11], "train_step": [5, 10, 11], "follow": 5, "config": [5, 10, 11], "job_config": 5, "config_fil": 5, "dump_fold": 5, "descript": 5, "print_arg": 5, "file": 5, "folder": 5, "dump": 5, "llama3": [5, 8], "flavor": [5, 10, 11], "debugmodel": 5, "hf_assets_path": [5, 10, 11], "test": 5, "asset": 5, "token": [5, 10, 11], "tokenizer_path": 5, "convert": 5, "print_after_convers": 5, "comma": 5, "float8": 5, "swap": 5, "nn": 5, "linear": 5, "float8linear": 5, "instal": 5, "torchao": 5, "found": 5, "ao": 5, "path": [5, 10, 11], "hf": [5, 10, 11], "local": [5, 12], "hug": 5, "face": 5, "safetensor": 5, "index": [5, 8], "json": 5, "fqn": 5, "map": [5, 10, 12], "generation_config": 5, "stdout": 5, "after": 5, "have": [5, 11, 12], "been": 5, "instead": [5, 11, 12], "deprec": 5, "adamw": [5, 10, 11], "lr": [5, 10, 11], "0": [5, 10, 11, 12], "0008": 5, "beta1": 5, "9": 5, "beta2": 5, "95": [5, 10], "ep": 5, "1e": [5, 10, 11], "08": 5, "weight_decai": 5, "fuse": 5, "early_step_in_backward": 5, "exponenti": 5, "move": 5, "averag": [5, 11], "hyperparamet": 5, "caution": 5, "optimizer_in_backward": 5, "compat": 5, "clip": 5, "register_post_accumulate_grad_hook": 5, "epsilon": 5, "cuda": 5, "best": 5, "foreach": 5, "some": [5, 10, 11, 13], "horizont": 5, "fusion": 5, "better": [5, 10], "slowest": [5, 11], "more": [5, 11, 13], "info": 5, "http": 5, "org": 5, "doc": [5, 13], "stabl": 5, "html": 5, "decai": 5, "dataset": [5, 10], "c4_test": 5, "dataset_path": 5, "local_batch_s": [5, 10, 11], "8": [5, 10, 11, 12], "global_batch_s": 5, "seq_len": [5, 10, 11], "2048": [5, 10, 11], "max_norm": 5, "10000": 5, "enable_cpu_offload": 5, "float32": 5, "mixed_precision_param": 5, "bfloat16": [5, 10], "mixed_precision_reduc": 5, "gc_freq": 5, "50": 5, "gc_debug": 5, "seed": 5, "determinist": 5, "download": 5, "wherev": 5, "possibl": 5, "slower": 5, "contrast": 5, "training_dtyp": 5, "put": 5, "extra": 5, "fp32": 5, "full": [5, 10, 11], "bf16": 5, "rope": 5, "calcul": 5, "still": 5, "cpu": [5, 10, 11, 12], "offload": 5, "gc": 5, "everi": 5, "detect": 5, "cycl": 5, "note": [5, 10, 11, 12], "want": [5, 11], "lower": 5, "avoid": [5, 11], "too": [5, 11, 13], "python": [5, 11], "interv": 5, "global": 5, "batch": [5, 10, 11], "degre": 5, "e": 5, "devic": 5, "max": 5, "norm": 5, "fully_shard": 5, "autocast": 5, "take": 5, "effect": [5, 6, 11, 12], "data_parallel_shard_degre": 5, "context_parallel_degre": 5, "data_replicate_degre": 5, "under": [5, 11], "ddp": 5, "reduct": 5, "choos": [5, 11, 12], "rng": 5, "data_parallel_replicate_degre": 5, "enable_compiled_autograd": 5, "fsdp_reshard_after_forward": 5, "tensor_parallel_degre": 5, "disable_loss_parallel": 5, "enable_async_tensor_parallel": 5, "pipeline_parallel_degre": 5, "pipeline_parallel_split_point": 5, "module_fqns_per_model_part": 5, "pipeline_parallel_first_stage_less_lay": 5, "pipeline_parallel_last_stage_less_lay": 5, "pipeline_parallel_layers_per_stag": 5, "pipeline_parallel_schedul": 5, "1f1b": 5, "pipeline_parallel_schedule_csv": 5, "pipeline_parallel_microbatch_s": 5, "context_parallel_rotate_method": 5, "allgath": 5, "expert_parallel_degre": 5, "expert_tensor_parallel_degre": 5, "mean": [5, 12], "sdpa": 5, "kv": 5, "exchang": 5, "gather": [5, 10, 11], "first": [5, 11], "sub": 5, "alltoal": 5, "shuffl": 5, "replic": [5, 10], "greater": 5, "than": [5, 11], "also": 5, "hsdp": 5, "hybrid": 5, "leftov": 5, "dp_replic": 5, "sp": 5, "neg": 5, "compiledautograd": 5, "expert": 5, "No": [5, 10, 12], "non": [5, 11], "moe": 5, "constraint": 5, "etp": 5, "dp_shard": 5, "experiment": 5, "relax": 5, "soon": [5, 11, 13], "flexibl": 5, "devicemesh": 5, "With": 5, "rout": [5, 10, 12], "param": 5, "either": 5, "partial": 5, "reshard_after_forward": 5, "within": [5, 11], "behavior": 5, "trade": 5, "off": 5, "see": [5, 10, 11], "api": [5, 8, 10, 11, 12, 13], "alwai": [5, 12], "never": 5, "reshard": 5, "smart": 5, "known": 5, "scenario": [5, 9], "qualifi": 5, "chunk": 5, "inner": 5, "repres": 5, "one": [5, 11, 12], "belong": 5, "g": 5, "tok_embed": 5, "layer": [5, 10, 12, 13], "3": [5, 8, 13], "4": [5, 10, 11, 12], "second": 5, "third": 5, "explicit": 5, "over": 5, "compar": [5, 10], "split": 5, "pipelin": [5, 10], "physic": 5, "stage": 5, "reduc": 5, "ha": [5, 10, 11], "overhead": 5, "embed": 5, "present": 5, "last": 5, "virtual": 5, "microbatch": 5, "total": [5, 11], "divid": 5, "must": 5, "evenli": 5, "divis": 5, "stages_per_rank": 5, "interleaved1f1b": 5, "split_point": 5, "csv": 5, "pipelineschedulesingl": 5, "pipelineschedulemulti": 5, "_pipelinescheduleruntim": 5, "begin": 5, "caus": 5, "remain": 5, "autom": 5, "futur": [5, 12], "500": 5, "initial_load_path": 5, "initial_load_model_onli": 5, "initial_load_in_hf": 5, "last_save_model_onli": 5, "last_save_in_hf": 5, "export_dtyp": 5, "async_mod": 5, "keep_latest_k": 5, "10": [5, 11], "load_step": 5, "exclude_from_load": 5, "enable_first_step_checkpoint": 5, "create_seed_checkpoint": 5, "synchron": [5, 10], "async_sav": 5, "async_with_pinned_mem": 5, "util": [5, 10], "dedic": 5, "pin": 5, "space": 5, "faster": [5, 11], "transfer": 5, "elimin": [5, 11], "gil": 5, "content": 5, "cost": 5, "increas": [5, 11], "insuffici": 5, "degrad": [5, 10], "due": 5, "page": [5, 8], "suffic": 5, "small": [5, 10], "order": 5, "ten": 5, "frequenc": [5, 11], "emploi": 5, "pursu": 5, "zero": [5, 9], "time": [5, 10], "given": 5, "appropri": 5, "hardwar": [5, 12], "ampl": 5, "fast": [5, 11], "pcie": 5, "save": 5, "py": [5, 10, 11], "ani": [5, 10, 11], "ngpu": 5, "could": 5, "script": 5, "share": [5, 11], "code": [5, 10, 11], "immedi": [5, 11], "correctli": 5, "cluster": [5, 12], "storag": [5, 10, 11], "verifi": [5, 10, 11, 12], "wait": [5, 10, 11], "frequent": 5, "exclud": 5, "being": [5, 10, 11], "dataload": [5, 10, 11], "huggingfac": 5, "necessari": 5, "transform": 5, "doesn": [5, 11], "dure": 5, "treat": [5, 10], "standard": 5, "no_initial_load_model_onli": 5, "overrid": 5, "particularli": 5, "resum": 5, "previou": [5, 11, 12], "empti": 5, "locat": [5, 12], "ignor": 5, "continu": [5, 10, 11, 12], "affect": 5, "ones": 5, "pre_train": 5, "llama3_8b": 5, "step_10000": 5, "keep": [5, 10], "latest": [5, 12], "k": 5, "purg": 5, "older": 5, "cannot": 5, "As": 5, "metadata": 5, "readi": [5, 11], "yet": [5, 11], "fill": 5, "disk": 5, "final": [5, 11], "There": 5, "consolid": 5, "On": 5, "isn": 5, "end": [5, 11], "weights_onli": 5, "convers": [5, 11], "train_stat": 5, "guid": [6, 7, 9, 12, 13], "cover": [6, 10], "fundament": [6, 12, 13], "behind": [6, 10, 11], "help": [6, 7, 9, 12], "understand": [6, 10, 11, 12, 13], "work": [6, 10, 12], "its": [6, 12], "welcom": [7, 13], "supervis": [7, 8, 10], "tune": [7, 8, 9], "adapt": 7, "task": 7, "label": 7, "scale": [7, 9, 12], "nightli": 8, "minimum": 8, "popular": 8, "8b": 8, "qwen3": [8, 10, 11, 12], "7b": [8, 10, 11, 12], "concept": [8, 11, 12], "tutori": 8, "search": 8, "master": 9, "theori": 9, "product": [9, 11], "let": [10, 12], "simpl": [10, 11, 12], "tutor": 10, "exact": [10, 11], "question": [10, 11], "answer": [10, 11], "reward": [10, 11], "qualiti": [10, 11], "give": [10, 11, 13], "score": [10, 11], "origin": 10, "prevent": 10, "drift": 10, "baselin": 10, "replai": 10, "buffer": 10, "experi": [10, 11], "conceptu": [10, 11, 13], "app": [10, 11, 12], "def": [10, 11, 12], "conceptual_rl_step": 10, "student": 10, "teacher": 10, "grade": 10, "reward_model": 10, "compute_logprob": 10, "5": [10, 11, 12], "episod": [10, 11], "replay_buff": [10, 11], "add": [10, 11, 12], "6": [10, 12], "enough": [10, 11], "improv": 10, "curr_policy_vers": [10, 11], "below": [10, 13], "actual": 10, "insight": [10, 11], "becom": 10, "abov": 10, "look": [10, 11, 12], "again": 10, "would": [10, 11], "conceptual_forge_rl_step": 10, "datasetactor": [10, 11], "call_on": [10, 11, 12], "respons": [10, 11], "rewardactor": [10, 11], "reward_actor": [10, 11], "evaluate_respons": [10, 11], "input_id": [10, 11], "max_req_token": [10, 11], "return_logprob": [10, 11], "ref_logprob": [10, 11], "ref_model": [10, 11], "create_episode_from_respons": 10, "pattern": [10, 12], "logic": 10, "now": [10, 11, 12], "auto": 10, "realis": 10, "worri": [10, 11], "about": [10, 11], "infra": 10, "automag": 10, "scene": [10, 11], "write": [10, 11], "algorthm": 10, "our": [10, 12, 13], "throughput": [10, 11], "heurist": 10, "massiv": 10, "bank": 10, "intens": 10, "o": 10, "bandwidth": [10, 11], "latenc": [10, 11], "low": 10, "n": [10, 11], "busi": 10, "plu": 10, "v": [10, 12], "failur": [10, 11, 12], "cascad": [10, 12], "halt": 10, "entir": [10, 13], "failov": [10, 11], "while": [10, 11, 12], "bottleneck": [10, 11, 12], "wast": 10, "naive_rl_step": 10, "idl": 10, "policy_model": 10, "compute_loss": 10, "ineffici": 10, "everyth": 10, "policy_fail": 10, "reward_fail": 10, "trainer_fail": 10, "entire_system_stop": 10, "solv": 10, "unit": 10, "easi": 10, "recoveri": [10, 11], "semant": 10, "notic": 10, "quick": [10, 13], "send": [10, 11, 12], "balanc": 10, "fanout": [10, 12], "real_rl_training_step": 10, "environ": 10, "just": [10, 12], "cat": [10, 11], "prompt_id": [10, 11], "unsqueez": [10, 11], "512": [10, 11], "tupl": [10, 11], "line": [10, 11], "pseudocod": 10, "hidden": 10, "demand": 10, "import": [10, 11, 12], "replaybuff": [10, 11], "rltrainer": [10, 11], "computeadvantag": [10, 11], "mathreward": [10, 11], "thinkingreward": [10, 11], "asyncio": [10, 11, 12], "qwen": [10, 11, 12], "group_siz": 10, "compute_advantag": [10, 11], "openai": [10, 11], "gsm8k": [10, 11], "revis": [10, 11], "data_split": [10, 11], "stream": 10, "engine_config": [10, 11], "tensor_parallel_s": [10, 11], "pipeline_parallel_s": [10, 11], "enforce_eag": [10, 11], "sampling_config": [10, 11], "max_token": [10, 11], "16": [10, 11], "temperatur": [10, 11], "top_p": [10, 11], "come": [10, 11, 13], "yaml": 10, "real": [10, 12], "batch_siz": [10, 11], "max_policy_ag": [10, 11], "dp_size": [10, 11], "reward_funct": [10, 11], "two": 10, "own": [10, 12], "intern": [10, 11, 12, 13], "distinct": 10, "explain": [10, 11, 13], "respawn": 10, "background": 10, "impact": [10, 11, 12], "retri": [10, 11], "grace": 10, "applic": [10, 12], "monolith": 10, "next": [10, 11, 13], "go": [10, 11], "deeper": [10, 13], "forgeservic": 10, "highli": 11, "recommend": 11, "read": 11, "thei": [11, 12], "land": 11, "power": [11, 12], "happen": 11, "hood": 11, "grab": [11, 13], "chai": [11, 13], "policy_servic": 11, "don": [11, 12], "right": 11, "serviceconfig": 11, "remot": [11, 12], "messag": [11, 12], "serial": 11, "done": 11, "serviceactor": [11, 12], "serviceinterfac": 11, "But": 11, "adverb": 11, "normal": 11, "extract": 11, "check": [11, 12], "fail": [11, 12], "pick": 11, "round": 11, "robin": 11, "characterist": 11, "lowest": 11, "network": 11, "hop": 11, "capac": 11, "critic": 11, "choic": 11, "stateless": 11, "current_vers": 11, "version_replica_1": 11, "version_replica_2": 11, "new_policy_vers": 11, "simultan": 11, "unless": 11, "gotcha": 11, "contact": 11, "arriv": 11, "els": 11, "sleep": 11, "much": 11, "higher": 11, "hit": 11, "preserv": [11, 12], "sticki": 11, "counter": [11, 12], "demonstr": 11, "between": 11, "regular": 11, "forgecount": 11, "__init__": [11, 12], "self": [11, 12], "initial_valu": [11, 12], "int": [11, 12], "increment": [11, 12], "get_valu": [11, 12], "reset": 11, "counter_servic": 11, "goe": [11, 13], "might": 11, "inconsist": 11, "WITH": 11, "nuse": 11, "final_valu": 11, "turn": 11, "response1": 11, "turn1": 11, "full_prompt": 11, "turn2": 11, "response2": 11, "both": 11, "challeng": 11, "maxim": 11, "ti": 11, "histori": 11, "break": 11, "naive_multi_turn": 11, "miss": 11, "question1": 11, "response3": 11, "conversation_so_far": 11, "optimized_multi_turn": 11, "guarante": 11, "reus": 11, "recomput": 11, "collector": 11, "concurr": 11, "thread": 11, "safe": 11, "clarifi": 11, "singleton": 11, "step_numb": 11, "addit": 11, "evict": 11, "old": 11, "state_dict": 11, "natur": [11, 13], "safeti": 11, "sequenti": 11, "those": 11, "real_weight_sync": 11, "push": 11, "policy_vers": 11, "simple_rl_step": 11, "rollout": 11, "correct": 11, "field": 11, "action": 11, "episode_id": 11, "pad_id": 11, "pad_token_id": 11, "request_len": 11, "response_len": 11, "request_token": 11, "tolist": 11, "response_token": 11, "dimens": 11, "new_group": 11, "Not": 11, "simplifi": 11, "alreadi": 11, "rang": 11, "4f": 11, "independ": [11, 12], "model_nam": 11, "fewer": 11, "heavi": 11, "float": 11, "total_reward": 11, "reward_fn": 11, "contribut": 11, "len": 11, "15": 11, "240": 11, "36": 11, "usual": 11, "around": 11, "math": 11, "322": 11, "344": 11, "successfulli": 11, "production_training_loop": 11, "create_episode_from_grpo_data": 11, "observ": 11, "select": 11, "seri": 12, "peel": 12, "back": 12, "framework": 12, "crucial": 12, "abstract": 12, "organ": 12, "think": 12, "dimension": 12, "grid": 12, "topologi": 12, "this_host": 12, "spawn_proc": 12, "per_host": 12, "7": 12, "beauti": 12, "seamlessli": 12, "cluster_proc": 12, "spawn_cluster_proc": 12, "host1": 12, "host2": 12, "host3": 12, "11": 12, "stai": 12, "100": 12, "my_actor": 12, "myactor": 12, "chang": 12, "educ": 12, "this_proc": 12, "defin": 12, "fut": 12, "One": 12, "random": 12, "fire": 12, "forget": 12, "rememb": [12, 13], "raw": 12, "policy_actor": 12, "isol": 12, "transpar": 12, "ident": 12, "race": 12, "condit": 12, "lock": 12, "hide": 12, "issu": 12, "gracefulli": 12, "recov": 12, "maximum": 12, "know": 12, "spawn_servic": 12, "ml": 13, "mention": 13, "pleas": 13, "inspir": 13, "z": 13, "shoutout": 13, "friend": 13, "part": 13, "terminologi": 13, "refresh": 13, "teach": 13, "101": 13, "talk": 13, "upon": 13, "consum": 13, "roughli": 13, "hour": 13, "enjoi": 13, "eager": 13, "checkout": 13}, "objects": {"forge.actors.generator": [[2, 0, 1, "", "Generator"], [2, 0, 1, "", "GeneratorWorker"]], "forge.actors.generator.Generator": [[2, 1, 1, "", "engine_args"], [2, 1, 1, "", "generate"], [2, 1, 1, "", "get_version"], [2, 1, 1, "", "get_vllm_config"], [2, 1, 1, "", "register_worker"], [2, 2, 1, "", "run"], [2, 1, 1, "", "sampling_params"], [2, 1, 1, "", "save_model_params"], [2, 1, 1, "", "setup"], [2, 2, 1, "", "shutdown"], [2, 1, 1, "", "stop"], [2, 1, 1, "", "update_weights"], [2, 1, 1, "", "use_dcp_for_weight_sync"], [2, 1, 1, "", "validate_model_params"]], "forge.actors.generator.GeneratorWorker": [[2, 1, 1, "", "execute_model"], [2, 1, 1, "", "save_model_params"], [2, 1, 1, "", "setup"], [2, 1, 1, "", "setup_kv_cache"], [2, 1, 1, "", "update_weights"], [2, 1, 1, "", "validate_model_params"], [2, 1, 1, "", "vllm_config"]], "forge.actors.reference_model": [[3, 0, 1, "", "ReferenceModel"]], "forge.actors.reference_model.ReferenceModel": [[3, 1, 1, "", "checkpoint"], [3, 1, 1, "", "comm"], [3, 1, 1, "", "compile"], [3, 1, 1, "", "forward"], [3, 1, 1, "", "model"], [3, 1, 1, "", "parallelism"], [3, 1, 1, "", "setup"], [3, 1, 1, "", "training"]], "forge.actors.trainer": [[5, 0, 1, "", "RLTrainer"]], "forge.actors.trainer.RLTrainer": [[5, 1, 1, "", "activation_checkpoint"], [5, 1, 1, "", "checkpoint"], [5, 1, 1, "", "cleanup"], [5, 1, 1, "", "comm"], [5, 1, 1, "", "compile"], [5, 1, 1, "", "dcp_path"], [5, 2, 1, "", "forward_backward"], [5, 1, 1, "", "job"], [5, 2, 1, "", "loss"], [5, 1, 1, "", "lr_scheduler"], [5, 1, 1, "", "memory_estimation"], [5, 1, 1, "", "model"], [5, 1, 1, "", "optimizer"], [5, 1, 1, "", "parallelism"], [5, 1, 1, "", "push_weights"], [5, 1, 1, "", "quantize"], [5, 1, 1, "", "setup"], [5, 1, 1, "", "state_dict_key"], [5, 1, 1, "", "train_step"], [5, 1, 1, "", "training"], [5, 1, 1, "", "use_dcp"]], "forge.controller.actor": [[1, 0, 1, "", "ForgeActor"]], "forge.controller.actor.ForgeActor": [[1, 2, 1, "", "as_actor"], [1, 1, 1, "", "hosts"], [1, 2, 1, "", "launch"], [1, 1, 1, "", "mesh_name"], [1, 1, 1, "", "num_replicas"], [1, 2, 1, "", "options"], [1, 1, 1, "", "procs"], [1, 2, 1, "", "shutdown"], [1, 1, 1, "", "with_gpus"]], "forge.controller.service.service": [[4, 0, 1, "", "Service"]], "forge.controller.service.service.Service": [[4, 2, 1, "", "call_all"], [4, 2, 1, "", "get_metrics"], [4, 2, 1, "", "get_metrics_summary"], [4, 2, 1, "", "start_session"], [4, 2, 1, "", "stop"], [4, 2, 1, "", "terminate_session"]], "torchtitan.config.job_config": [[5, 0, 1, "", "Checkpoint"], [5, 0, 1, "", "Job"], [5, 0, 1, "", "Model"], [5, 0, 1, "", "Optimizer"], [5, 0, 1, "", "Parallelism"], [5, 0, 1, "", "Training"]], "torchtitan.config.job_config.Checkpoint": [[5, 1, 1, "", "async_mode"], [5, 1, 1, "", "create_seed_checkpoint"], [5, 1, 1, "", "enable"], [5, 1, 1, "", "enable_first_step_checkpoint"], [5, 1, 1, "", "exclude_from_loading"], [5, 1, 1, "", "export_dtype"], [5, 1, 1, "", "folder"], [5, 1, 1, "", "initial_load_in_hf"], [5, 1, 1, "", "initial_load_model_only"], [5, 1, 1, "", "initial_load_path"], [5, 1, 1, "", "interval"], [5, 1, 1, "", "keep_latest_k"], [5, 1, 1, "", "last_save_in_hf"], [5, 1, 1, "", "last_save_model_only"], [5, 1, 1, "", "load_step"]], "torchtitan.config.job_config.Job": [[5, 1, 1, "", "config_file"], [5, 1, 1, "", "description"], [5, 1, 1, "", "dump_folder"], [5, 1, 1, "", "print_args"]], "torchtitan.config.job_config.Model": [[5, 1, 1, "", "converters"], [5, 1, 1, "", "flavor"], [5, 1, 1, "", "hf_assets_path"], [5, 1, 1, "", "name"], [5, 1, 1, "", "print_after_conversion"], [5, 1, 1, "", "tokenizer_path"]], "torchtitan.config.job_config.Optimizer": [[5, 1, 1, "", "beta1"], [5, 1, 1, "", "beta2"], [5, 1, 1, "", "early_step_in_backward"], [5, 1, 1, "", "eps"], [5, 1, 1, "", "implementation"], [5, 1, 1, "", "lr"], [5, 1, 1, "", "name"], [5, 1, 1, "", "weight_decay"]], "torchtitan.config.job_config.Parallelism": [[5, 1, 1, "", "context_parallel_degree"], [5, 1, 1, "", "context_parallel_rotate_method"], [5, 1, 1, "", "data_parallel_replicate_degree"], [5, 1, 1, "", "data_parallel_shard_degree"], [5, 1, 1, "", "disable_loss_parallel"], [5, 1, 1, "", "enable_async_tensor_parallel"], [5, 1, 1, "", "enable_compiled_autograd"], [5, 1, 1, "", "expert_parallel_degree"], [5, 1, 1, "", "expert_tensor_parallel_degree"], [5, 1, 1, "", "fsdp_reshard_after_forward"], [5, 1, 1, "", "module_fqns_per_model_part"], [5, 1, 1, "", "pipeline_parallel_degree"], [5, 1, 1, "", "pipeline_parallel_first_stage_less_layers"], [5, 1, 1, "", "pipeline_parallel_last_stage_less_layers"], [5, 1, 1, "", "pipeline_parallel_layers_per_stage"], [5, 1, 1, "", "pipeline_parallel_microbatch_size"], [5, 1, 1, "", "pipeline_parallel_schedule"], [5, 1, 1, "", "pipeline_parallel_schedule_csv"], [5, 1, 1, "", "pipeline_parallel_split_points"], [5, 1, 1, "", "tensor_parallel_degree"]], "torchtitan.config.job_config.Training": [[5, 1, 1, "", "dataset"], [5, 1, 1, "", "dataset_path"], [5, 1, 1, "", "deterministic"], [5, 1, 1, "", "dtype"], [5, 1, 1, "", "enable_cpu_offload"], [5, 1, 1, "", "gc_debug"], [5, 1, 1, "", "gc_freq"], [5, 1, 1, "", "global_batch_size"], [5, 1, 1, "", "local_batch_size"], [5, 1, 1, "", "max_norm"], [5, 1, 1, "", "mixed_precision_param"], [5, 1, 1, "", "mixed_precision_reduce"], [5, 1, 1, "", "seed"], [5, 1, 1, "", "seq_len"], [5, 1, 1, "", "steps"]]}, "objtypes": {"0": "py:class", "1": "py:attribute", "2": "py:method"}, "objnames": {"0": ["py", "class", "Python class"], "1": ["py", "attribute", "Python attribute"], "2": ["py", "method", "Python method"]}, "titleterms": {"api": 0, "refer": [0, 11], "overview": 0, "forgeactor": 1, "gener": 2, "generatorwork": 2, "model": [3, 5], "referencemodel": 3, "servic": [4, 10, 11, 12], "trainer": 5, "rltrainer": 5, "configur": [5, 11], "job": 5, "optim": 5, "train": [5, 11], "parallel": 5, "checkpoint": 5, "concept": [6, 10], "get": 7, "start": 7, "welcom": 8, "torchforg": [8, 10, 11, 12, 13], "document": 8, "kei": [8, 12], "featur": 8, "content": 8, "indic": 8, "tabl": 8, "tutori": [9, 13], "part": [10, 11, 12], "1": [10, 11], "rl": [10, 13], "fundament": 10, "us": [10, 12], "terminologi": 10, "core": 10, "compon": [10, 11], "The": [10, 11, 12], "toi": 10, "exampl": [10, 11], "teach": 10, "math": 10, "defin": 10, "name": 10, "learn": [10, 12], "flow": 10, "from": [10, 13], "step": 10, "why": [10, 12], "thi": [10, 12], "matter": [10, 12], "tradit": 10, "ml": 10, "infrastructur": [10, 12], "fail": 10, "challeng": 10, "problem": [10, 11], "differ": 10, "resourc": 10, "need": 10, "2": [10, 11], "complex": 10, "interdepend": 10, "3": [10, 11, 12], "coordin": [10, 11], "enter": 10, "nativ": 10, "architectur": [10, 12], "what": [10, 11, 12], "make": 10, "power": 10, "automat": 10, "manag": [10, 11], "independ": 10, "scale": [10, 11, 13], "fault": 10, "toler": 10, "peel": 11, "back": 11, "abstract": 11, "ar": 11, "anatomi": 11, "beyond": 11, "interfac": 11, "deep": [11, 12], "dive": [11, 12], "real": 11, "creation": [11, 12], "how": [11, 12], "actual": 11, "work": 11, "commun": 11, "pattern": 11, "quick": 11, "rout": 11, "load": 11, "balanc": 11, "singl": [11, 12], "replica": 11, "fanout": 11, "broadcast": 11, "result": 11, "collect": 11, "stream": 11, "oper": 11, "custom": 11, "implement": [11, 13], "session": 11, "state": 11, "realiti": 11, "kv": 11, "cach": 11, "replai": 11, "buffer": 11, "consist": 11, "weight": 11, "synchron": 11, "strategi": 11, "asynchron": 11, "approach": 11, "let": 11, "handl": 11, "speed": 11, "mismatch": 11, "orchestr": 11, "loop": 11, "monarch": 12, "connect": 12, "complet": 12, "hierarchi": 12, "silicon": 12, "procmesh": 12, "foundat": 12, "host": 12, "multi": 12, "actor": 12, "mesh": 12, "your": 12, "code": 12, "run": 12, "distribut": 12, "process": 12, "call": 12, "execut": 12, "multipl": 12, "share": 12, "insight": 12, "conclus": 12, "you": 12, "ve": 12, "takeawai": 12, "zero": 13, "theori": 13, "product": 13, "structur": 13}, "envversion": {"sphinx.domains.c": 3, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 9, "sphinx.domains.index": 1, "sphinx.domains.javascript": 3, "sphinx.domains.math": 2, "sphinx.domains.python": 4, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx_last_updated_by_git": 1, "sphinx.ext.intersphinx": 1, "sphinx.ext.viewcode": 1, "sphinx": 60}, "alltitles": {"API Reference": [[0, "api-reference"]], "Overview": [[0, "overview"]], "ForgeActor": [[1, "forgeactor"]], "Generator": [[2, "generator"], [2, "id1"]], "GeneratorWorker": [[2, "generatorworker"]], "Model": [[3, "model"]], "ReferenceModel": [[3, "referencemodel"]], "Service": [[4, "service"]], "Trainer": [[5, "trainer"]], "RLTrainer": [[5, "rltrainer"]], "Configuration": [[5, "configuration"]], "Job Configuration": [[5, "job-configuration"]], "Model Configuration": [[5, "model-configuration"]], "Optimizer Configuration": [[5, "optimizer-configuration"]], "Training Configuration": [[5, "training-configuration"]], "Parallelism Configuration": [[5, "parallelism-configuration"]], "Checkpoint Configuration": [[5, "checkpoint-configuration"]], "Concepts": [[6, "concepts"]], "Get Started": [[7, "get-started"]], "Welcome to TorchForge documentation!": [[8, "welcome-to-torchforge-documentation"]], "Key Features": [[8, "key-features"]], "Contents:": [[8, null]], "Indices and tables": [[8, "indices-and-tables"]], "Tutorials": [[9, "tutorials"]], "Part 1: RL Fundamentals - Using TorchForge Terminology": [[10, "part-1-rl-fundamentals-using-torchforge-terminology"]], "Core RL Components in TorchForge": [[10, "core-rl-components-in-torchforge"]], "The Toy Example: Teaching Math": [[10, "the-toy-example-teaching-math"]], "RL Components Defined (TorchForge Names)": [[10, "rl-components-defined-torchforge-names"]], "The RL Learning Flow": [[10, "the-rl-learning-flow"]], "From Concepts to TorchForge Services": [[10, "from-concepts-to-torchforge-services"]], "RL Step with TorchForge Services": [[10, "rl-step-with-torchforge-services"]], "Why This Matters: Traditional ML Infrastructure Fails": [[10, "why-this-matters-traditional-ml-infrastructure-fails"]], "The Infrastructure Challenge": [[10, "the-infrastructure-challenge"]], "Problem 1: Different Resource Needs": [[10, "problem-1-different-resource-needs"]], "Problem 2: Complex Interdependencies": [[10, "problem-2-complex-interdependencies"]], "Problem 3: The Coordination Challenge": [[10, "problem-3-the-coordination-challenge"]], "Enter TorchForge: RL-Native Architecture": [[10, "enter-torchforge-rl-native-architecture"]], "What Makes This Powerful": [[10, "what-makes-this-powerful"]], "Automatic Resource Management": [[10, "automatic-resource-management"]], "Independent Scaling": [[10, "independent-scaling"]], "Fault Tolerance": [[10, "fault-tolerance"]], "Part 2: Peeling Back the Abstraction - What Are Services?": [[11, "part-2-peeling-back-the-abstraction-what-are-services"]], "Service Anatomy: Beyond the Interface": [[11, "service-anatomy-beyond-the-interface"]], "Service Components Deep Dive": [[11, "service-components-deep-dive"]], "1. Real Service Configuration": [[11, "real-service-configuration"]], "2. Real Service Creation": [[11, "real-service-creation"]], "3. How Services Actually Work": [[11, "how-services-actually-work"]], "Communication Patterns: Quick Reference": [[11, "communication-patterns-quick-reference"]], "Deep Dive: Service Communication Patterns": [[11, "deep-dive-service-communication-patterns"]], "1. .route() - Load Balanced Single Replica": [[11, "route-load-balanced-single-replica"]], "2. .fanout() - Broadcast with Results Collection": [[11, "fanout-broadcast-with-results-collection"]], "3. Streaming Operations - Custom Implementation Pattern": [[11, "streaming-operations-custom-implementation-pattern"]], "3. Service Sessions for Stateful Operations": [[11, "service-sessions-for-stateful-operations"]], "Deep Dive: State Management Reality": [[11, "deep-dive-state-management-reality"]], "The KV Cache Problem": [[11, "the-kv-cache-problem"]], "Replay Buffer Consistency": [[11, "replay-buffer-consistency"]], "Weight Synchronization Strategy": [[11, "weight-synchronization-strategy"]], "Deep Dive: Asynchronous Coordination Patterns": [[11, "deep-dive-asynchronous-coordination-patterns"]], "The TorchForge Approach: Let Services Handle Coordination": [[11, "the-torchforge-approach-let-services-handle-coordination"]], "Handling Speed Mismatches with Service Scaling": [[11, "handling-speed-mismatches-with-service-scaling"]], "Service Implementation Example": [[11, "service-implementation-example"]], "Service Orchestration: The Training Loop": [[11, "service-orchestration-the-training-loop"]], "Part 3: The TorchForge-Monarch Connection": [[12, "part-3-the-torchforge-monarch-connection"]], "The Complete Hierarchy: Service to Silicon": [[12, "the-complete-hierarchy-service-to-silicon"]], "Deep Dive: ProcMesh - The Foundation": [[12, "deep-dive-procmesh-the-foundation"]], "Single Host ProcMesh": [[12, "single-host-procmesh"]], "Multi-Host ProcMesh": [[12, "multi-host-procmesh"]], "Actor Meshes: Your Code Running Distributed": [[12, "actor-meshes-your-code-running-distributed"]], "How TorchForge Services Use Monarch": [[12, "how-torchforge-services-use-monarch"]], "The Service Creation Process": [[12, "the-service-creation-process"]], "Service Call to Actor Execution": [[12, "service-call-to-actor-execution"]], "Multiple Services Sharing Infrastructure": [[12, "multiple-services-sharing-infrastructure"]], "Key Insights: Why This Architecture Matters": [[12, "key-insights-why-this-architecture-matters"]], "Conclusion": [[12, "conclusion"]], "What You\u2019ve Learned": [[12, "what-you-ve-learned"]], "Key Takeaways": [[12, "key-takeaways"]], "Zero to TorchForge: From RL Theory to Production-Scale Implementation": [[13, "zero-to-torchforge-from-rl-theory-to-production-scale-implementation"]], "Tutorial Structure": [[13, "tutorial-structure"]]}, "indexentries": {"forgeactor (class in forge.controller.actor)": [[1, "forge.controller.actor.ForgeActor"]], "as_actor() (forge.controller.actor.forgeactor class method)": [[1, "forge.controller.actor.ForgeActor.as_actor"]], "hosts (forge.controller.actor.forgeactor attribute)": [[1, "forge.controller.actor.ForgeActor.hosts"]], "launch() (forge.controller.actor.forgeactor class method)": [[1, "forge.controller.actor.ForgeActor.launch"]], "mesh_name (forge.controller.actor.forgeactor attribute)": [[1, "forge.controller.actor.ForgeActor.mesh_name"]], "num_replicas (forge.controller.actor.forgeactor attribute)": [[1, "forge.controller.actor.ForgeActor.num_replicas"]], "options() (forge.controller.actor.forgeactor class method)": [[1, "forge.controller.actor.ForgeActor.options"]], "procs (forge.controller.actor.forgeactor attribute)": [[1, "forge.controller.actor.ForgeActor.procs"]], "shutdown() (forge.controller.actor.forgeactor class method)": [[1, "forge.controller.actor.ForgeActor.shutdown"]], "with_gpus (forge.controller.actor.forgeactor attribute)": [[1, "forge.controller.actor.ForgeActor.with_gpus"]], "generator (class in forge.actors.generator)": [[2, "forge.actors.generator.Generator"]], "generatorworker (class in forge.actors.generator)": [[2, "forge.actors.generator.GeneratorWorker"]], "engine_args (forge.actors.generator.generator attribute)": [[2, "forge.actors.generator.Generator.engine_args"]], "execute_model (forge.actors.generator.generatorworker attribute)": [[2, "forge.actors.generator.GeneratorWorker.execute_model"]], "generate (forge.actors.generator.generator attribute)": [[2, "forge.actors.generator.Generator.generate"]], "get_version (forge.actors.generator.generator attribute)": [[2, "forge.actors.generator.Generator.get_version"]], "get_vllm_config (forge.actors.generator.generator attribute)": [[2, "forge.actors.generator.Generator.get_vllm_config"]], "register_worker (forge.actors.generator.generator attribute)": [[2, "forge.actors.generator.Generator.register_worker"]], "run() (forge.actors.generator.generator method)": [[2, "forge.actors.generator.Generator.run"]], "sampling_params (forge.actors.generator.generator attribute)": [[2, "forge.actors.generator.Generator.sampling_params"]], "save_model_params (forge.actors.generator.generator attribute)": [[2, "forge.actors.generator.Generator.save_model_params"]], "save_model_params (forge.actors.generator.generatorworker attribute)": [[2, "forge.actors.generator.GeneratorWorker.save_model_params"]], "setup (forge.actors.generator.generator attribute)": [[2, "forge.actors.generator.Generator.setup"]], "setup (forge.actors.generator.generatorworker attribute)": [[2, "forge.actors.generator.GeneratorWorker.setup"]], "setup_kv_cache (forge.actors.generator.generatorworker attribute)": [[2, "forge.actors.generator.GeneratorWorker.setup_kv_cache"]], "shutdown() (forge.actors.generator.generator class method)": [[2, "forge.actors.generator.Generator.shutdown"]], "stop (forge.actors.generator.generator attribute)": [[2, "forge.actors.generator.Generator.stop"]], "update_weights (forge.actors.generator.generator attribute)": [[2, "forge.actors.generator.Generator.update_weights"]], "update_weights (forge.actors.generator.generatorworker attribute)": [[2, "forge.actors.generator.GeneratorWorker.update_weights"]], "use_dcp_for_weight_sync (forge.actors.generator.generator attribute)": [[2, "forge.actors.generator.Generator.use_dcp_for_weight_sync"]], "validate_model_params (forge.actors.generator.generator attribute)": [[2, "forge.actors.generator.Generator.validate_model_params"]], "validate_model_params (forge.actors.generator.generatorworker attribute)": [[2, "forge.actors.generator.GeneratorWorker.validate_model_params"]], "vllm_config (forge.actors.generator.generatorworker attribute)": [[2, "forge.actors.generator.GeneratorWorker.vllm_config"]], "referencemodel (class in forge.actors.reference_model)": [[3, "forge.actors.reference_model.ReferenceModel"]], "checkpoint (forge.actors.reference_model.referencemodel attribute)": [[3, "forge.actors.reference_model.ReferenceModel.checkpoint"]], "comm (forge.actors.reference_model.referencemodel attribute)": [[3, "forge.actors.reference_model.ReferenceModel.comm"]], "compile (forge.actors.reference_model.referencemodel attribute)": [[3, "forge.actors.reference_model.ReferenceModel.compile"]], "forward (forge.actors.reference_model.referencemodel attribute)": [[3, "forge.actors.reference_model.ReferenceModel.forward"]], "model (forge.actors.reference_model.referencemodel attribute)": [[3, "forge.actors.reference_model.ReferenceModel.model"]], "parallelism (forge.actors.reference_model.referencemodel attribute)": [[3, "forge.actors.reference_model.ReferenceModel.parallelism"]], "setup (forge.actors.reference_model.referencemodel attribute)": [[3, "forge.actors.reference_model.ReferenceModel.setup"]], "training (forge.actors.reference_model.referencemodel attribute)": [[3, "forge.actors.reference_model.ReferenceModel.training"]], "service (class in forge.controller.service.service)": [[4, "forge.controller.service.service.Service"]], "call_all() (forge.controller.service.service.service method)": [[4, "forge.controller.service.service.Service.call_all"]], "get_metrics() (forge.controller.service.service.service method)": [[4, "forge.controller.service.service.Service.get_metrics"]], "get_metrics_summary() (forge.controller.service.service.service method)": [[4, "forge.controller.service.service.Service.get_metrics_summary"]], "start_session() (forge.controller.service.service.service method)": [[4, "forge.controller.service.service.Service.start_session"]], "stop() (forge.controller.service.service.service method)": [[4, "forge.controller.service.service.Service.stop"]], "terminate_session() (forge.controller.service.service.service method)": [[4, "forge.controller.service.service.Service.terminate_session"]], "checkpoint (class in torchtitan.config.job_config)": [[5, "torchtitan.config.job_config.Checkpoint"]], "job (class in torchtitan.config.job_config)": [[5, "torchtitan.config.job_config.Job"]], "model (class in torchtitan.config.job_config)": [[5, "torchtitan.config.job_config.Model"]], "optimizer (class in torchtitan.config.job_config)": [[5, "torchtitan.config.job_config.Optimizer"]], "parallelism (class in torchtitan.config.job_config)": [[5, "torchtitan.config.job_config.Parallelism"]], "rltrainer (class in forge.actors.trainer)": [[5, "forge.actors.trainer.RLTrainer"]], "training (class in torchtitan.config.job_config)": [[5, "torchtitan.config.job_config.Training"]], "activation_checkpoint (forge.actors.trainer.rltrainer attribute)": [[5, "forge.actors.trainer.RLTrainer.activation_checkpoint"]], "async_mode (torchtitan.config.job_config.checkpoint attribute)": [[5, "torchtitan.config.job_config.Checkpoint.async_mode"]], "beta1 (torchtitan.config.job_config.optimizer attribute)": [[5, "torchtitan.config.job_config.Optimizer.beta1"]], "beta2 (torchtitan.config.job_config.optimizer attribute)": [[5, "torchtitan.config.job_config.Optimizer.beta2"]], "checkpoint (forge.actors.trainer.rltrainer attribute)": [[5, "forge.actors.trainer.RLTrainer.checkpoint"]], "cleanup (forge.actors.trainer.rltrainer attribute)": [[5, "forge.actors.trainer.RLTrainer.cleanup"]], "comm (forge.actors.trainer.rltrainer attribute)": [[5, "forge.actors.trainer.RLTrainer.comm"]], "compile (forge.actors.trainer.rltrainer attribute)": [[5, "forge.actors.trainer.RLTrainer.compile"]], "config_file (torchtitan.config.job_config.job attribute)": [[5, "torchtitan.config.job_config.Job.config_file"]], "context_parallel_degree (torchtitan.config.job_config.parallelism attribute)": [[5, "torchtitan.config.job_config.Parallelism.context_parallel_degree"]], "context_parallel_rotate_method (torchtitan.config.job_config.parallelism attribute)": [[5, "torchtitan.config.job_config.Parallelism.context_parallel_rotate_method"]], "converters (torchtitan.config.job_config.model attribute)": [[5, "torchtitan.config.job_config.Model.converters"]], "create_seed_checkpoint (torchtitan.config.job_config.checkpoint attribute)": [[5, "torchtitan.config.job_config.Checkpoint.create_seed_checkpoint"]], "data_parallel_replicate_degree (torchtitan.config.job_config.parallelism attribute)": [[5, "torchtitan.config.job_config.Parallelism.data_parallel_replicate_degree"]], "data_parallel_shard_degree (torchtitan.config.job_config.parallelism attribute)": [[5, "torchtitan.config.job_config.Parallelism.data_parallel_shard_degree"]], "dataset (torchtitan.config.job_config.training attribute)": [[5, "torchtitan.config.job_config.Training.dataset"]], "dataset_path (torchtitan.config.job_config.training attribute)": [[5, "torchtitan.config.job_config.Training.dataset_path"]], "dcp_path (forge.actors.trainer.rltrainer attribute)": [[5, "forge.actors.trainer.RLTrainer.dcp_path"]], "description (torchtitan.config.job_config.job attribute)": [[5, "torchtitan.config.job_config.Job.description"]], "deterministic (torchtitan.config.job_config.training attribute)": [[5, "torchtitan.config.job_config.Training.deterministic"]], "disable_loss_parallel (torchtitan.config.job_config.parallelism attribute)": [[5, "torchtitan.config.job_config.Parallelism.disable_loss_parallel"]], "dtype (torchtitan.config.job_config.training attribute)": [[5, "torchtitan.config.job_config.Training.dtype"]], "dump_folder (torchtitan.config.job_config.job attribute)": [[5, "torchtitan.config.job_config.Job.dump_folder"]], "early_step_in_backward (torchtitan.config.job_config.optimizer attribute)": [[5, "torchtitan.config.job_config.Optimizer.early_step_in_backward"]], "enable (torchtitan.config.job_config.checkpoint attribute)": [[5, "torchtitan.config.job_config.Checkpoint.enable"]], "enable_async_tensor_parallel (torchtitan.config.job_config.parallelism attribute)": [[5, "torchtitan.config.job_config.Parallelism.enable_async_tensor_parallel"]], "enable_compiled_autograd (torchtitan.config.job_config.parallelism attribute)": [[5, "torchtitan.config.job_config.Parallelism.enable_compiled_autograd"]], "enable_cpu_offload (torchtitan.config.job_config.training attribute)": [[5, "torchtitan.config.job_config.Training.enable_cpu_offload"]], "enable_first_step_checkpoint (torchtitan.config.job_config.checkpoint attribute)": [[5, "torchtitan.config.job_config.Checkpoint.enable_first_step_checkpoint"]], "eps (torchtitan.config.job_config.optimizer attribute)": [[5, "torchtitan.config.job_config.Optimizer.eps"]], "exclude_from_loading (torchtitan.config.job_config.checkpoint attribute)": [[5, "torchtitan.config.job_config.Checkpoint.exclude_from_loading"]], "expert_parallel_degree (torchtitan.config.job_config.parallelism attribute)": [[5, "torchtitan.config.job_config.Parallelism.expert_parallel_degree"]], "expert_tensor_parallel_degree (torchtitan.config.job_config.parallelism attribute)": [[5, "torchtitan.config.job_config.Parallelism.expert_tensor_parallel_degree"]], "export_dtype (torchtitan.config.job_config.checkpoint attribute)": [[5, "torchtitan.config.job_config.Checkpoint.export_dtype"]], "flavor (torchtitan.config.job_config.model attribute)": [[5, "torchtitan.config.job_config.Model.flavor"]], "folder (torchtitan.config.job_config.checkpoint attribute)": [[5, "torchtitan.config.job_config.Checkpoint.folder"]], "forward_backward() (forge.actors.trainer.rltrainer method)": [[5, "forge.actors.trainer.RLTrainer.forward_backward"]], "fsdp_reshard_after_forward (torchtitan.config.job_config.parallelism attribute)": [[5, "torchtitan.config.job_config.Parallelism.fsdp_reshard_after_forward"]], "gc_debug (torchtitan.config.job_config.training attribute)": [[5, "torchtitan.config.job_config.Training.gc_debug"]], "gc_freq (torchtitan.config.job_config.training attribute)": [[5, "torchtitan.config.job_config.Training.gc_freq"]], "global_batch_size (torchtitan.config.job_config.training attribute)": [[5, "torchtitan.config.job_config.Training.global_batch_size"]], "hf_assets_path (torchtitan.config.job_config.model attribute)": [[5, "torchtitan.config.job_config.Model.hf_assets_path"]], "implementation (torchtitan.config.job_config.optimizer attribute)": [[5, "torchtitan.config.job_config.Optimizer.implementation"]], "initial_load_in_hf (torchtitan.config.job_config.checkpoint attribute)": [[5, "torchtitan.config.job_config.Checkpoint.initial_load_in_hf"]], "initial_load_model_only (torchtitan.config.job_config.checkpoint attribute)": [[5, "torchtitan.config.job_config.Checkpoint.initial_load_model_only"]], "initial_load_path (torchtitan.config.job_config.checkpoint attribute)": [[5, "torchtitan.config.job_config.Checkpoint.initial_load_path"]], "interval (torchtitan.config.job_config.checkpoint attribute)": [[5, "torchtitan.config.job_config.Checkpoint.interval"]], "job (forge.actors.trainer.rltrainer attribute)": [[5, "forge.actors.trainer.RLTrainer.job"]], "keep_latest_k (torchtitan.config.job_config.checkpoint attribute)": [[5, "torchtitan.config.job_config.Checkpoint.keep_latest_k"]], "last_save_in_hf (torchtitan.config.job_config.checkpoint attribute)": [[5, "torchtitan.config.job_config.Checkpoint.last_save_in_hf"]], "last_save_model_only (torchtitan.config.job_config.checkpoint attribute)": [[5, "torchtitan.config.job_config.Checkpoint.last_save_model_only"]], "load_step (torchtitan.config.job_config.checkpoint attribute)": [[5, "torchtitan.config.job_config.Checkpoint.load_step"]], "local_batch_size (torchtitan.config.job_config.training attribute)": [[5, "torchtitan.config.job_config.Training.local_batch_size"]], "loss() (forge.actors.trainer.rltrainer method)": [[5, "forge.actors.trainer.RLTrainer.loss"]], "lr (torchtitan.config.job_config.optimizer attribute)": [[5, "torchtitan.config.job_config.Optimizer.lr"]], "lr_scheduler (forge.actors.trainer.rltrainer attribute)": [[5, "forge.actors.trainer.RLTrainer.lr_scheduler"]], "max_norm (torchtitan.config.job_config.training attribute)": [[5, "torchtitan.config.job_config.Training.max_norm"]], "memory_estimation (forge.actors.trainer.rltrainer attribute)": [[5, "forge.actors.trainer.RLTrainer.memory_estimation"]], "mixed_precision_param (torchtitan.config.job_config.training attribute)": [[5, "torchtitan.config.job_config.Training.mixed_precision_param"]], "mixed_precision_reduce (torchtitan.config.job_config.training attribute)": [[5, "torchtitan.config.job_config.Training.mixed_precision_reduce"]], "model (forge.actors.trainer.rltrainer attribute)": [[5, "forge.actors.trainer.RLTrainer.model"]], "module_fqns_per_model_part (torchtitan.config.job_config.parallelism attribute)": [[5, "torchtitan.config.job_config.Parallelism.module_fqns_per_model_part"]], "name (torchtitan.config.job_config.model attribute)": [[5, "torchtitan.config.job_config.Model.name"]], "name (torchtitan.config.job_config.optimizer attribute)": [[5, "torchtitan.config.job_config.Optimizer.name"]], "optimizer (forge.actors.trainer.rltrainer attribute)": [[5, "forge.actors.trainer.RLTrainer.optimizer"]], "parallelism (forge.actors.trainer.rltrainer attribute)": [[5, "forge.actors.trainer.RLTrainer.parallelism"]], "pipeline_parallel_degree (torchtitan.config.job_config.parallelism attribute)": [[5, "torchtitan.config.job_config.Parallelism.pipeline_parallel_degree"]], "pipeline_parallel_first_stage_less_layers (torchtitan.config.job_config.parallelism attribute)": [[5, "torchtitan.config.job_config.Parallelism.pipeline_parallel_first_stage_less_layers"]], "pipeline_parallel_last_stage_less_layers (torchtitan.config.job_config.parallelism attribute)": [[5, "torchtitan.config.job_config.Parallelism.pipeline_parallel_last_stage_less_layers"]], "pipeline_parallel_layers_per_stage (torchtitan.config.job_config.parallelism attribute)": [[5, "torchtitan.config.job_config.Parallelism.pipeline_parallel_layers_per_stage"]], "pipeline_parallel_microbatch_size (torchtitan.config.job_config.parallelism attribute)": [[5, "torchtitan.config.job_config.Parallelism.pipeline_parallel_microbatch_size"]], "pipeline_parallel_schedule (torchtitan.config.job_config.parallelism attribute)": [[5, "torchtitan.config.job_config.Parallelism.pipeline_parallel_schedule"]], "pipeline_parallel_schedule_csv (torchtitan.config.job_config.parallelism attribute)": [[5, "torchtitan.config.job_config.Parallelism.pipeline_parallel_schedule_csv"]], "pipeline_parallel_split_points (torchtitan.config.job_config.parallelism attribute)": [[5, "torchtitan.config.job_config.Parallelism.pipeline_parallel_split_points"]], "print_after_conversion (torchtitan.config.job_config.model attribute)": [[5, "torchtitan.config.job_config.Model.print_after_conversion"]], "print_args (torchtitan.config.job_config.job attribute)": [[5, "torchtitan.config.job_config.Job.print_args"]], "push_weights (forge.actors.trainer.rltrainer attribute)": [[5, "forge.actors.trainer.RLTrainer.push_weights"]], "quantize (forge.actors.trainer.rltrainer attribute)": [[5, "forge.actors.trainer.RLTrainer.quantize"]], "seed (torchtitan.config.job_config.training attribute)": [[5, "torchtitan.config.job_config.Training.seed"]], "seq_len (torchtitan.config.job_config.training attribute)": [[5, "torchtitan.config.job_config.Training.seq_len"]], "setup (forge.actors.trainer.rltrainer attribute)": [[5, "forge.actors.trainer.RLTrainer.setup"]], "state_dict_key (forge.actors.trainer.rltrainer attribute)": [[5, "forge.actors.trainer.RLTrainer.state_dict_key"]], "steps (torchtitan.config.job_config.training attribute)": [[5, "torchtitan.config.job_config.Training.steps"]], "tensor_parallel_degree (torchtitan.config.job_config.parallelism attribute)": [[5, "torchtitan.config.job_config.Parallelism.tensor_parallel_degree"]], "tokenizer_path (torchtitan.config.job_config.model attribute)": [[5, "torchtitan.config.job_config.Model.tokenizer_path"]], "train_step (forge.actors.trainer.rltrainer attribute)": [[5, "forge.actors.trainer.RLTrainer.train_step"]], "training (forge.actors.trainer.rltrainer attribute)": [[5, "forge.actors.trainer.RLTrainer.training"]], "use_dcp (forge.actors.trainer.rltrainer attribute)": [[5, "forge.actors.trainer.RLTrainer.use_dcp"]], "weight_decay (torchtitan.config.job_config.optimizer attribute)": [[5, "torchtitan.config.job_config.Optimizer.weight_decay"]]}})